<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-observability/alerting-with-grafana" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.8.1">
<title data-rh="true">Alerting with Grafana | SKIP</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://skip.kartverket.no/docs/observability/alerting-with-grafana"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Alerting with Grafana | SKIP"><meta data-rh="true" name="description" content="Grafana Alerting"><meta data-rh="true" property="og:description" content="Grafana Alerting"><link data-rh="true" rel="icon" href="/img/favicon/favicon.ico"><link data-rh="true" rel="canonical" href="https://skip.kartverket.no/docs/observability/alerting-with-grafana"><link data-rh="true" rel="alternate" href="https://skip.kartverket.no/docs/observability/alerting-with-grafana" hreflang="en"><link data-rh="true" rel="alternate" href="https://skip.kartverket.no/docs/observability/alerting-with-grafana" hreflang="x-default"><script data-rh="true" type="application/ld+json">{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"🔭 Observabilitet","item":"https://skip.kartverket.no/docs/observability/"},{"@type":"ListItem","position":2,"name":"Alerting with Grafana","item":"https://skip.kartverket.no/docs/observability/alerting-with-grafana"}]}</script><link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="SKIP RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="SKIP Atom Feed">
<link rel="alternate" type="application/json" href="/blog/feed.json" title="SKIP JSON Feed">







<script src="https://platform.twitter.com/widgets.js"></script><link rel="stylesheet" href="/assets/css/styles.5c884a55.css">
<script src="/assets/js/runtime~main.66b084c8.js" defer="defer"></script>
<script src="/assets/js/main.f076a633.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<svg xmlns="http://www.w3.org/2000/svg" style="display: none;"><defs>
<symbol id="theme-svg-external-link" viewBox="0 0 24 24"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"/></symbol>
</defs></svg>
<script>!function(){var t="light";var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();document.documentElement.setAttribute("data-theme",e||t),document.documentElement.setAttribute("data-theme-choice",e||t)}(),function(){try{const c=new URLSearchParams(window.location.search).entries();for(var[t,e]of c)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><link rel="preload" as="image" href="/img/skip.png"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="theme-layout-navbar navbar navbar--fixed-top"><div class="navbar__inner"><div class="theme-layout-navbar-left navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/skip.png" alt="SKIP" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/skip.png" alt="SKIP" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">SKIP</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs">Docs</a><a class="navbar__item navbar__link" href="/blog">Tech Blog</a></div><div class="theme-layout-navbar-right navbar__items navbar__items--right"><a href="https://kartverket.atlassian.net/wiki/spaces/SIK/overview" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Sikkerhetshåndboka<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><a href="https://github.com/kartverket" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="system mode" aria-label="Switch between dark and light mode (currently system mode)"><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" aria-hidden="true" class="toggleIcon_g3eP systemToggleIcon_QzmC"><path fill="currentColor" d="m12 21c4.971 0 9-4.029 9-9s-4.029-9-9-9-9 4.029-9 9 4.029 9 9 9zm4.95-13.95c1.313 1.313 2.05 3.093 2.05 4.95s-0.738 3.637-2.05 4.95c-1.313 1.313-3.093 2.05-4.95 2.05v-14c1.857 0 3.637 0.737 4.95 2.05z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input id="search_input_react" type="search" placeholder="Loading..." aria-label="Search" class="navbar__search-input search-bar" disabled=""></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="theme-layout-main main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs">Velkommen til SKIP! 🎉</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/kom-i-gang">💡 Kom i gang</a><button aria-label="Expand sidebar category &#x27;💡 Kom i gang&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/applikasjon-utrulling">🚀 Applikasjon &amp; utrulling</a><button aria-label="Expand sidebar category &#x27;🚀 Applikasjon &amp; utrulling&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/jobber-skip">📅 Jobber på SKIP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/trafikkstyring">🚦 Trafikkstyring</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/lagring">💾 Lagring</a><button aria-label="Expand sidebar category &#x27;💾 Lagring&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/observability">🔭 Observabilitet</a><button aria-label="Collapse sidebar category &#x27;🔭 Observabilitet&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/grafana">Grafana</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/metrikker">Metrikker</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/distributed-tracing-with-tempo">Distributed tracing with Tempo</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/dashboard">Dashboards</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/grafana-and-GCP">Grafana and GCP</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/observability/alerting-with-grafana">Alerting with Grafana</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/logs-with-Loki">Logs with Loki</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/recording-and-alerting-rules">Recording and alerting rules</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/grafana-cheat-sheet">Grafana cheat sheet</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/observability/real-user-monitoring-with-Faro">Real User Monitoring with Faro</a></li></ul></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><a class="breadcrumbs__link" href="/docs/observability"><span>🔭 Observabilitet</span></a></li><li class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link">Alerting with Grafana</span></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Alerting with Grafana</h1></header>
<p><img decoding="async" loading="lazy" alt="Grafana Alerting" src="/assets/images/alerting_with_grafana_header-b7e1151800db923a9aac6685775d6f9c.png" width="2560" height="1355" class="img_ev3q"></p>
<p>Applications on SKIP use <a href="https://grafana.com/" target="_blank" rel="noopener noreferrer">Grafana</a> for monitoring for unexpected changes in the system. When an alert is fired it can be either handled as a critical alert sent to several channels, including SMS and email, or as a non-critical alert that is handled during office hours by the product team.</p>
<p>Here are some useful links for handling alerts:</p>
<ul>
<li><a href="https://github.com/kartverket/grafana-alerts" target="_blank" rel="noopener noreferrer">Alert config (grafana-alerts on GitHub)</a></li>
<li><a href="https://monitoring.kartverket.cloud/alerting/list?view=state" target="_blank" rel="noopener noreferrer">Alert dashboard</a></li>
<li><a href="https://monitoring.kartverket.cloud/d/dd79f2b5-feca-45ff-9396-f67d22adc3c5/alerts?orgId=1" target="_blank" rel="noopener noreferrer">Critical alerts dashboard</a></li>
<li><a href="https://monitoring.kartverket.cloud/a/grafana-oncall-app/alert-groups" target="_blank" rel="noopener noreferrer">Current active incidents</a></li>
<li><a href="https://monitoring.kartverket.cloud/d/fU-WBSqWz/synthetic-monitoring-summary?dashboard=summary&amp;orgId=1" target="_blank" rel="noopener noreferrer">Synthetic Monitoring overview</a></li>
<li><a href="https://monitoring.kartverket.cloud/a/grafana-synthetic-monitoring-app/checks" target="_blank" rel="noopener noreferrer">Synthetic Monitoring checks</a></li>
<li><a href="https://monitoring.kartverket.cloud/alerting/silences" target="_blank" rel="noopener noreferrer">Planned alert silences (maintainance periods)</a></li>
<li><a href="https://monitoring.kartverket.cloud/a/grafana-oncall-app/schedules?p=1" target="_blank" rel="noopener noreferrer">Alert Schedules</a></li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="creating-alerts">Creating alerts<a href="#creating-alerts" class="hash-link" aria-label="Direct link to Creating alerts" title="Direct link to Creating alerts">​</a></h2>
<p>The first step to start adding alerts to your application is to onboard that app to SKIP. Grafana is only used for SKIP, the rest of Kartverket uses Zabbix. Once you have been onboarded and deployed your app to SKIP you can request access to the <a href="https://github.com/kartverket/grafana-alerts" target="_blank" rel="noopener noreferrer">grafana-alerts</a> repo.</p>
<p>The grafana-alerts repo is designed to be a repo that contains the alerts of all teams and handles deployment of alerts to Grafana. You will get a file which contains the configuration of your alerts in a Terraform format. For example, the file could look like this:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">resource </span><span class="token keyword type variable" style="color:#36acaa">&quot;grafana_folder&quot;</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MYTEAMNAME_folder&quot;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">for_each</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> local.envs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">title</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Alerts MYTEAMNAME </span><span class="token string interpolation punctuation" style="color:#393A34">$</span><span class="token string interpolation punctuation" style="color:#393A34">{</span><span class="token string interpolation" style="color:#e3116c">each</span><span class="token string interpolation punctuation" style="color:#393A34">.</span><span class="token string interpolation" style="color:#e3116c">key</span><span class="token string interpolation punctuation" style="color:#393A34">}</span><span class="token string" style="color:#e3116c">&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">module</span><span class="token keyword type variable" style="color:#36acaa"> &quot;MYTEAMNAME_alerts_kubernetes&quot; </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">source</span><span class="token plain">   </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../modules/grafana_alert_group&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">for_each</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> local.envs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">name</span><span class="token plain">             </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;kube-state-metrics&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">env</span><span class="token plain">              </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> each.value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">runbook_base_url</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic"># URL to document describing each alert</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">folder_uid</span><span class="token plain">       </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> grafana_folder.MYTEAMNAME_folder</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">each.key</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">.uid</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">team</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">name</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;MYTEAMNAME&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">alerts</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">KubernetesPodNotHealthy</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">summary</span><span class="token plain">     </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Kubernetes Pod not healthy (instance {{ $labels.instance }})&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">description</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Pod has been in a non-ready state for longer than 15 minutes.\n  VALUE = {{ $value }}\n  LABELS = {{ $labels }}&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">severity</span><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;critical&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">for</span><span class="token plain">         </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;15m&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token property" style="color:#36acaa">expr</span><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token heredoc string" style="color:#e3116c">&lt;&lt;EOT</span><br></span><span class="token-line" style="color:#393A34"><span class="token heredoc string" style="color:#e3116c">          sum by (namespace, pod) (kube_pod_status_phase{phase=~&quot;Pending|Unknown|Failed&quot;, namespace=~&quot;nrl-.*&quot;})</span><br></span><span class="token-line" style="color:#393A34"><span class="token heredoc string" style="color:#e3116c">      EOT</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain">,</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic"># ... more alerts</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>In the above file we create an alert that monitors the health of a pod in all nrl namespaces. Pay attention to the <code>expr</code> field, which is the Prometheus query language PromQL. If you want to learn more about PromQL look at the <a href="https://prometheus.io/docs/prometheus/latest/querying/basics/" target="_blank" rel="noopener noreferrer">documentation</a> as well as <a href="https://prometheus.io/docs/prometheus/latest/querying/examples/" target="_blank" rel="noopener noreferrer">some examples</a> from the Prometheus documentation and the examples at <a href="https://samber.github.io/awesome-prometheus-alerts/" target="_blank" rel="noopener noreferrer">awesome prometheus alerts</a> .</p>
<p>This is a file that you will be given CODEOWNER access to. This means that you and your team will be able to update this file and review your own changes without involving SKIP. Your team is expected to keep them at a level that verifies the running state of the application.</p>
<p>Updating this file in the GitHub repo will automatically deploy the changes to Grafana.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="grafana-oncall-alerts">Grafana Oncall Alerts<a href="#grafana-oncall-alerts" class="hash-link" aria-label="Direct link to Grafana Oncall Alerts" title="Direct link to Grafana Oncall Alerts">​</a></h2>
<p>In addition to Grafana alerts, we have installed a plugin to Grafana called Oncall. This plugin gives us the possibility of adding schedules/shifts and custom alerting behaviour. It also gives your team an overview and a system to handle alerts.</p>
<p><img decoding="async" loading="lazy" alt="Oncall Alerts" src="/assets/images/oncall_alerts-babdcce543e0a59c8d1826ac2020adfb.png" width="2096" height="728" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="integration">Integration<a href="#integration" class="hash-link" aria-label="Direct link to Integration" title="Direct link to Integration">​</a></h3>
<p>In order to start using Oncall you need an <a href="https://grafana.com/docs/oncall/latest/integrations/" target="_blank" rel="noopener noreferrer">oncall integration</a> to Grafana. This integration will show up as a contact point in Grafana which can be used in notification policies to route alerts to your integration.</p>
<p>From the integration you can add <a href="https://grafana.com/docs/oncall/latest/escalation-chains-and-routes/" target="_blank" rel="noopener noreferrer">routes and escalation chains</a> which decides how the integration will notify the team. The standard setup is to send all alerts to a slack channel, and also to a team member on schedule or shared inbox.</p>
<p><img decoding="async" loading="lazy" alt="SKIPs Oncall integration" src="/assets/images/oncall_integration-6f9f1701524e3e1107cd34897b0c3779.png" width="2246" height="702" class="img_ev3q"></p>
<p><img decoding="async" loading="lazy" alt="Grafana Contact point for an Oncall integration watchdog" src="data:image/png;base64,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" width="2225" height="41" class="img_ev3q"></p>
<p>In the grafana-alerts repository we have created an <code>oncall_integration</code> module, which you can use to create your teams integration.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="routes">Routes<a href="#routes" class="hash-link" aria-label="Direct link to Routes" title="Direct link to Routes">​</a></h3>
<p>In an integration you always have a default route, but you can also have a specified route. A route will decide which escalation chain the integration should use when it receives an alert. For example if you have a critical app that requires 24/7 alerting, you can create a route that checks for certain labels, and if found, it will route the alert to the “appdrift” escalation chain.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="schedules">Schedules<a href="#schedules" class="hash-link" aria-label="Direct link to Schedules" title="Direct link to Schedules">​</a></h3>
<p>An <a href="https://grafana.com/docs/oncall/latest/on-call-schedules/web-schedule/" target="_blank" rel="noopener noreferrer">Oncall Schedule</a> is a collection of “Shifts”. In short this means that you can assign a person to a shift, and that person will receive all alerts sent to the Oncall integration for the duration of their shift. In the grafana-alerts repository you can use the <code>oncall_team</code> integration to create both a schedule and escalation chain.</p>
<p><img decoding="async" loading="lazy" alt="Oncall Schedule" src="/assets/images/oncall_schedule-88b1aafa807ddf7ff25bacac91f054ca.png" width="2250" height="794" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="escalation-chains">Escalation Chains<a href="#escalation-chains" class="hash-link" aria-label="Direct link to Escalation Chains" title="Direct link to Escalation Chains">​</a></h3>
<p><a href="https://grafana.com/docs/oncall/latest/escalation-chains-and-routes/" target="_blank" rel="noopener noreferrer">Escalation chains</a> are instructions to Oncall on how to notify you when the connected integration receives an alert. The standard setup here is to contact the assigned person in the set way in Oncall.</p>
<p>The escalation chain below will contact the person which has an assigned shift in Schedule, in the way they have set in Oncall. Usually email or slack mentions.</p>
<p><img decoding="async" loading="lazy" alt="Escalation Chain" src="/assets/images/oncall_escalationchain-e07e7ac1c28a2d8d3847ae3b26a730ad.png" width="2241" height="487" class="img_ev3q"></p>
<p>In Oncall → Users → edit user, you can decide how you want the escalation chain to contact you.</p>
<p><img decoding="async" loading="lazy" alt="Edit user" src="/assets/images/oncall_edituser-31a4dd907d788e4d942ff68d32f95541.png" width="1872" height="1005" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="terraform">Terraform<a href="#terraform" class="hash-link" aria-label="Direct link to Terraform" title="Direct link to Terraform">​</a></h3>
<p>A typical Grafana Oncall setup for a team will look like this:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">module</span><span class="token keyword type variable" style="color:#36acaa"> &quot;team_oncall&quot; </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">source</span><span class="token plain">                      </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../modules/oncall_team&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">team_name</span><span class="token plain">                   </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;team&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">use_schedule</span><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">module</span><span class="token keyword type variable" style="color:#36acaa"> &quot;team_integration&quot; </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">source</span><span class="token plain">                      </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../modules/oncall_integration&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">integration_name</span><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;team&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">slack_channel_name</span><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;grafana-oncall&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//Not required, replace with your own</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">vaktlag_enabled</span><span class="token plain">             </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">default_escalation_chain_id</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> module.team_oncall.team_escalation_chain_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<div class="theme-admonition theme-admonition-note admonition_xJq3 alert alert--secondary"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_BuS1"><p>The slack channel must already exist in grafana.</p><p>If you want to use predefined users instead of a schedule, then the users must already exist in Oncall.</p></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="notification-policies">Notification policies<a href="#notification-policies" class="hash-link" aria-label="Direct link to Notification policies" title="Direct link to Notification policies">​</a></h3>
<p>You also have to configure notification policies to use your integration. Terraform doesn’t activate the contact point of the integration yet, so this has to be done manually before adding this to terraform(do this by navigating to your integration and activate the contact point). Add code <a href="https://github.com/kartverket/grafana-alerts/blob/main/atkv1-prod/policies.tf" target="_blank" rel="noopener noreferrer">here.</a></p>
<p>Example:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">policy</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">contact_point</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;watchdog&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">group_by</span><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;cluster&quot;</span><span class="token plain">, </span><span class="token string" style="color:#e3116c">&quot;alertname&quot;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">matcher</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">label</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;team&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">match</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;=&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token property" style="color:#36acaa">value</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;Vaktlag&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="244-alerting">24/4 alerting<a href="#244-alerting" class="hash-link" aria-label="Direct link to 24/4 alerting" title="Direct link to 24/4 alerting">​</a></h2>
<p>Once you have configured a set of alerts, you might want them to be monitored 24/7. Kartverket provides a solution for this in the form of “Vaktlaget”. Vaktlaget is a team consisting of various people in IT-drift that have a special agreement that allows them to be notified and follow up when an alert fires outside of normal working hours.</p>
<p>The first step for getting your alerts onboarded onto vaktlaget is to maintain a set of alerts that only fire when there is a serious outage. Keep in mind that an alert that fires will potentially wake people in the middle of the night, so it is paramount that this set of alerts don’t contain non-critical or “flaky” alerts. These alerts should be given a severity of “critical” to make them distinct from other alerts.</p>
<p>Once you have done this you need to contact vaktlaget to discuss the alerts you wish to onboard. They will comment on what is important enough to be onboarded and you will end up with a set of alerts that is a neat balance between ensuring the stability of our systems and preserving the mental health of the people on the alert schedule.</p>
<p>After you’ve discussed with vaktlaget you can contact SKIP in #gen-skip to have your alert integration be switched over. When this is done, all alerts labeled with env=prod and severity=critical will be sent to vaktlaget using the following schedule:</p>
<ul>
<li>The alerts will be sent to your slack channel all day</li>
<li>The alerts will be sent to appdrift as email, SMS and phone call between 7 and 22</li>
<li>The alerts will be sent to infrastrukturdrift as email, SMS and phone call between 22 and 7</li>
</ul>
<p>You can also create a pull request in grafana-alerts with the vaktlag escalation chain added to your integration:</p>
<div class="language-hcl codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_QJqH"><pre tabindex="0" class="prism-code language-hcl codeBlock_bY9V thin-scrollbar" style="color:#393A34;background-color:#f6f8fa"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">module</span><span class="token keyword type variable" style="color:#36acaa"> &quot;skip&quot; </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">source</span><span class="token plain">                      </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;../modules/oncall_integration&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">integration_name</span><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;skip&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">slack_channel_name</span><span class="token plain">          </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;grafana-oncall&quot;</span><span class="token plain"> </span><span class="token comment" style="color:#999988;font-style:italic">//Not required, replace with your own</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">vaktlag_enabled</span><span class="token plain">             </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">vaktlag_escalation_chain_id</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> module.vaktlag.appdrift_escalation_chain_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token property" style="color:#36acaa">default_escalation_chain_id</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">=</span><span class="token plain"> module.skip.team_escalation_chain_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre></div></div>
<p>When you later add more alerts to the critical level you also need to discuss with vaktlaget so they can sign off on the new alerts before they are added.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="row margin-top--sm theme-doc-footer-edit-meta-row"><div class="col"><a href="https://github.com/kartverket/skip-docs/edit/main/docs/07-observability/04-alerting-with-grafana.md" target="_blank" rel="noopener noreferrer" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_Z9Sw" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_JAkA"></div></div></footer></article><nav class="docusaurus-mt-lg pagination-nav" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/observability/grafana-and-GCP"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Grafana and GCP</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/observability/logs-with-Loki"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Logs with Loki</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#creating-alerts" class="table-of-contents__link toc-highlight">Creating alerts</a></li><li><a href="#grafana-oncall-alerts" class="table-of-contents__link toc-highlight">Grafana Oncall Alerts</a><ul><li><a href="#integration" class="table-of-contents__link toc-highlight">Integration</a></li><li><a href="#routes" class="table-of-contents__link toc-highlight">Routes</a></li><li><a href="#schedules" class="table-of-contents__link toc-highlight">Schedules</a></li><li><a href="#escalation-chains" class="table-of-contents__link toc-highlight">Escalation Chains</a></li><li><a href="#terraform" class="table-of-contents__link toc-highlight">Terraform</a></li><li><a href="#notification-policies" class="table-of-contents__link toc-highlight">Notification policies</a></li></ul></li><li><a href="#244-alerting" class="table-of-contents__link toc-highlight">24/4 alerting</a></li></ul></div></div></div></div></main></div></div></div><footer class="theme-layout-footer footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="theme-layout-footer-column col footer__col"><div class="footer__title">Lenker</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://uustatus.no/nb/erklaringer/publisert/7148395f-f0cf-4019-9c45-3b83d79fd544" target="_blank" rel="noopener noreferrer" class="footer__link-item">Tilgjengelighetserklæring<svg width="13.5" height="13.5" aria-hidden="true" class="iconExternalLink_nPIU"><use href="#theme-svg-external-link"></use></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Statens Kartverk</div></div></div></footer></div>
</body>
</html>