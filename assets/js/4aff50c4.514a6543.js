"use strict";(globalThis.webpackChunkskip_docs=globalThis.webpackChunkskip_docs||[]).push([[1152],{96385(e,i,n){n.r(i),n.d(i,{assets:()=>l,contentTitle:()=>o,default:()=>g,frontMatter:()=>a,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"applikasjon-utrulling/argo-cd/argocd-notifications","title":"ArgoCD Notifications","description":"ArgoCD har st\xf8tte for \xe5 sende notifikasjoner basert p\xe5 forh\xe5ndsdefinerte triggers gjennom en rekke kanaler, deriblant Slack og Github. Eksempelvis kan dette v\xe6re triggers basert p\xe5 at synkroniseringen av en applikasjon feilet, eller at en applikasjon har blitt liggende i OutOfSync over et visst tidsrom.","source":"@site/docs/03-applikasjon-utrulling/09-argo-cd/06-argocd-notifications.md","sourceDirName":"03-applikasjon-utrulling/09-argo-cd","slug":"/applikasjon-utrulling/argo-cd/argocd-notifications","permalink":"/docs/applikasjon-utrulling/argo-cd/argocd-notifications","draft":false,"unlisted":false,"editUrl":"https://github.com/kartverket/skip-docs/edit/main/docs/03-applikasjon-utrulling/09-argo-cd/06-argocd-notifications.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Provisjonere infrastruktur med Crossplane","permalink":"/docs/applikasjon-utrulling/argo-cd/provisjonere-infrastruktur-med-crossplane"},"next":{"title":"Konfigurere applikasjons-repositorier med config.json","permalink":"/docs/applikasjon-utrulling/argo-cd/configuring-apps-repositories-with-configjson"}}');var r=n(74848),s=n(28453);const a={},o="ArgoCD Notifications",l={},d=[{value:"Slack",id:"slack",level:2},{value:"Github",id:"github",level:3},{value:"Standardnotifikasjoner",id:"standardnotifikasjoner",level:3},{value:"Ekstra triggers",id:"ekstra-triggers",level:3}];function c(e){const i={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,s.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(i.header,{children:(0,r.jsx)(i.h1,{id:"argocd-notifications",children:"ArgoCD Notifications"})}),"\n",(0,r.jsx)(i.p,{children:"ArgoCD har st\xf8tte for \xe5 sende notifikasjoner basert p\xe5 forh\xe5ndsdefinerte triggers gjennom en rekke kanaler, deriblant Slack og Github. Eksempelvis kan dette v\xe6re triggers basert p\xe5 at synkroniseringen av en applikasjon feilet, eller at en applikasjon har blitt liggende i OutOfSync over et visst tidsrom."}),"\n",(0,r.jsxs)(i.p,{children:[(0,r.jsx)(i.a,{href:"https://argocd-notifications.readthedocs.io/en/stable/",children:"ArgoCD Notifications er dokumentert her"}),"."]}),"\n",(0,r.jsx)(i.p,{children:"V\xe5r ArgoCD installasjon kommer med en rekke triggers og templates for utseende forh\xe5ndsinstallert."}),"\n",(0,r.jsxs)(i.p,{children:["Se ",(0,r.jsx)(i.a,{href:"https://github.com/kartverket/skip-apps/blob/main/bases/argocd/patches/argocd-notifications-templates.yml",children:"https://github.com/kartverket/skip-apps/blob/main/bases/argocd/patches/argocd-notifications-templates.yml"})," for hvilke triggers som er tilgjengelig."]}),"\n",(0,r.jsx)(i.h2,{id:"slack",children:"Slack"}),"\n",(0,r.jsx)(i.p,{children:"For Slack er det satt opp en notifikasjonskanal for hvert team p\xe5 m\xf8nster <teamnavn>-argocd-alerts, f.eks. #nrl-argocd-alerts. Disse kanalene er videre satt opp med integration mot Slack-appen \u201cArgoCD Notifications\u201d som tar imot meldinger fra ArgoCD og dytter de inn i korrekt kanal."}),"\n",(0,r.jsx)(i.p,{children:"(NB: Hvis du ikke finner en slik kanal for teamet ditt, kontakt en administrator for Kartverkets Slack og be om \xe5 f\xe5 opprettet en kanal med korrekt navnem\xf8nster og integrasjon mot \u201cArgoCD Notifications\u201d)."}),"\n",(0,r.jsx)(i.p,{children:(0,r.jsx)(i.img,{alt:"Fig 1. Eksempel p\xe5 Slack-notifikasjon",src:n(31274).A+"",width:"589",height:"213"})}),"\n",(0,r.jsx)(i.h3,{id:"github",children:"Github"}),"\n",(0,r.jsx)(i.p,{children:"For Github er det satt opp en app kalt \u201cKV ArgoCD Notifications\u201d som har mulighet til \xe5 skrive til Github workflow statuser til de forskjellige apps-repoene. Kontakt en av Kartverkets Github-administratorer dersom flere apps-repoer skal legges til her."}),"\n",(0,r.jsxs)(i.p,{children:["Eksempler p\xe5 notifikasjoner:\n",(0,r.jsx)(i.img,{alt:"Fig. 2 Et lite gr\xf8nt \u201ccheckmark\u201d indikerer at utrulling til ArgoCD har g\xe5tt bra",src:n(55959).A+"",width:"911",height:"122"}),"\n",(0,r.jsx)(i.img,{alt:"Fig.3 \u2026 og klikker man p\xe5 det f\xe5r man opp en liten detaljvisning med linker til ArgoCD",src:n(16054).A+"",width:"911",height:"214"})]}),"\n",(0,r.jsx)(i.h3,{id:"standardnotifikasjoner",children:"Standardnotifikasjoner"}),"\n",(0,r.jsx)(i.p,{children:"F\xf8lgende triggers er lagt til som standard for alle apps-repoer:"}),"\n",(0,r.jsxs)(i.table,{children:[(0,r.jsx)(i.thead,{children:(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.th,{children:(0,r.jsx)(i.strong,{children:"Trigger"})}),(0,r.jsx)(i.th,{children:(0,r.jsx)(i.strong,{children:"Kommunikasjonskanal"})}),(0,r.jsx)(i.th,{children:(0,r.jsx)(i.strong,{children:"N\xe5r trigges denne?"})})]})}),(0,r.jsxs)(i.tbody,{children:[(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-sync-failed.slack"})}),(0,r.jsx)(i.td,{children:"Slack"}),(0,r.jsx)(i.td,{children:"Synkronisering av applikasjon feilet"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-sync-failed.github"})}),(0,r.jsx)(i.td,{children:"Github"}),(0,r.jsx)(i.td,{children:"Synkronisering av applikasjon feilet"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-sync-succeeded.github"})}),(0,r.jsx)(i.td,{children:"Github"}),(0,r.jsx)(i.td,{children:"Synkronisering av applikasjon gikk bra"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-sync-running.github"})}),(0,r.jsx)(i.td,{children:"Github"}),(0,r.jsx)(i.td,{children:"Synkronisering av applikasjon kj\xf8rer"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-health-degraded.github"})}),(0,r.jsx)(i.td,{children:"Github"}),(0,r.jsx)(i.td,{children:"Helsesjekk av applikasjonen returnerer et \u201cdegraded\u201d-resultat"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-sync-status-unknown.github"})}),(0,r.jsx)(i.td,{children:"Github"}),(0,r.jsx)(i.td,{children:"Ukjent synkroniseringsstatus"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-deployed.github"})}),(0,r.jsx)(i.td,{children:"Github"}),(0,r.jsx)(i.td,{children:"Ny versjon av applikasjonen deployet til milj\xf8"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-outofsync-one-day.slack"})}),(0,r.jsx)(i.td,{children:"Slack"}),(0,r.jsx)(i.td,{children:"Applikasjonen har status OutOfSync i minst en dag (det har blitt sjekket inn endringer i apps-repoet som ikke har blitt deployet)"})]}),(0,r.jsxs)(i.tr,{children:[(0,r.jsx)(i.td,{children:(0,r.jsx)(i.code,{children:"notifications.argoproj.io/subscribe.on-outofsync-one-week.slack"})}),(0,r.jsx)(i.td,{children:"Slack"}),(0,r.jsx)(i.td,{children:"Applikasjonen har status OutOfSync i minst en uke (det har blitt sjekket inn endringer i apps-repoet som ikke har blitt deployet)"})]})]})]}),"\n",(0,r.jsx)(i.h3,{id:"ekstra-triggers",children:"Ekstra triggers"}),"\n",(0,r.jsxs)(i.p,{children:["I tillegg er det mulig \xe5 spesifisere andre triggers (s\xe5 lenge disse er lagt inn i ArgoCD) per team i objektet triggerSubscriptions i ",(0,r.jsx)(i.a,{href:"https://github.com/kartverket/skip-apps/blob/main/lib/argocd/argocd.libsonnet",children:"https://github.com/kartverket/skip-apps/blob/main/lib/argocd/argocd.libsonnet"})," ."]}),"\n",(0,r.jsx)(i.admonition,{type:"info",children:(0,r.jsx)(i.p,{children:"Husk \xe5 spesifisere om det er slack eller github notifikasjon man \xf8nsker ved \xe5 legge til suffikset .slack eller .github p\xe5 slutten av trigger, og husk \xe5 spesifisere kanalnavn ved bruk av slack notifikasjon"})}),"\n",(0,r.jsx)(i.pre,{children:(0,r.jsx)(i.code,{className:"language-javascript",children:"{\n    name: 'teamnavn',\n    oidcGroup: 'aabbbcc-123-321-ccbbbaa',\n    allowlistedPrefixes: [{ name: 'teamnavn' }],\n    triggerSubscriptions: {\n      'notifications.argoproj.io/subscribe.on-sync-succeeded.slack': 'navn-paa-slack-kanal',\n      'notifications.argoproj.io/subscribe.eksempel-trigger.github': '', # denne er blank siden det ikke er en kanal \xe5 sende til p\xe5 github\n    }\n},\n"})})]})}function g(e={}){const{wrapper:i}={...(0,s.R)(),...e.components};return i?(0,r.jsx)(i,{...e,children:(0,r.jsx)(c,{...e})}):c(e)}},55959(e,i,n){n.d(i,{A:()=>t});const t=n.p+"assets/images/594280578-739de65c1bcf3e3154e15cc64b79ec51.png"},16054(e,i,n){n.d(i,{A:()=>t});const t=n.p+"assets/images/594542693-719e56c5ea8f3ec9b11ec258a443f677.png"},31274(e,i,n){n.d(i,{A:()=>t});const t=n.p+"assets/images/595165215-2edab52f6cec9ca119644ca105c9f398.png"},28453(e,i,n){n.d(i,{R:()=>a,x:()=>o});var t=n(96540);const r={},s=t.createContext(r);function a(e){const i=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(i):{...i,...e}},[i,e])}function o(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:a(e.components),t.createElement(s.Provider,{value:i},e.children)}}}]);