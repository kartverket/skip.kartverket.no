"use strict";(self.webpackChunkskip_docs=self.webpackChunkskip_docs||[]).push([[367],{95116:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>c,contentTitle:()=>d,default:()=>u,frontMatter:()=>a,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"applikasjon-utrulling/tilgangsstyring/klientregistrering","title":"Klientregistrering","description":"Klientregistrering er en sentral del av tilgangsstyring med OAuth 2.0 og OIDC. N\xe5r du registrerer en klient, f\xe5r applikasjonen","source":"@site/docs/03-applikasjon-utrulling/04-tilgangsstyring/01-klientregistrering.mdx","sourceDirName":"03-applikasjon-utrulling/04-tilgangsstyring","slug":"/applikasjon-utrulling/tilgangsstyring/klientregistrering","permalink":"/docs/applikasjon-utrulling/tilgangsstyring/klientregistrering","draft":false,"unlisted":false,"editUrl":"https://github.com/kartverket/skip-docs/edit/main/docs/03-applikasjon-utrulling/04-tilgangsstyring/01-klientregistrering.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udd10 Tilgangsstyring p\xe5 SKIP","permalink":"/docs/applikasjon-utrulling/tilgangsstyring/"},"next":{"title":"Token-validering og grovkornet autorisasjon","permalink":"/docs/applikasjon-utrulling/tilgangsstyring/token-validering"}}');var s=r(74848),i=r(28453),l=r(11470),o=r(19365);const a={},d="Klientregistrering",c={},p=[{value:"\ud83d\udea7 UNDER UTVIKLING \ud83d\udea7",id:"-under-utvikling-",level:3},{value:"Spesifikasjonen til <code>AzureAdApplication</code>",id:"spesifikasjonen-til-azureadapplication",level:3},{value:"Eksempel",id:"eksempel",level:3},{value:"Spesifikasjonen til <code>IDPortenClient</code>",id:"spesifikasjonen-til-idportenclient",level:3},{value:"Eksempel",id:"eksempel-1",level:3},{value:"Spesifikasjonen til <code>MaskinportenClient</code>",id:"spesifikasjonen-til-maskinportenclient",level:3},{value:"Eksempel",id:"eksempel-2",level:3}];function g(e){const n={a:"a",code:"code",em:"em",h1:"h1",h3:"h3",header:"header",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,i.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"klientregistrering",children:"Klientregistrering"})}),"\n",(0,s.jsx)(n.p,{children:"Klientregistrering er en sentral del av tilgangsstyring med OAuth 2.0 og OIDC. N\xe5r du registrerer en klient, f\xe5r applikasjonen\nsin egen identitet og kan autentisere seg mot de valgte identitetstilbyderne."}),"\n",(0,s.jsxs)(n.p,{children:["Vi anbefaler \xe5 ha et bevisst forhold til hvilke tjenester som skal dele samme ",(0,s.jsx)(n.code,{children:"audience"}),".\nDet er ofte mer hensiktsmessig \xe5 velge en restriktiv tiln\xe6rming, der hver tjeneste f\xe5r sin egen klientregistrering,\nfremfor \xe5 gruppere flere tjenester under \xe9n felles klient. Dette gir bedre kontroll over tilgangsstyring og sikkerhet."]}),"\n",(0,s.jsx)(n.p,{children:"Felles for alle identitetstilbydere p\xe5 SKIP er at klientregistrering st\xf8ttes fra plattformen ved hjelp av Kubernetes-operatorer."}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/nais/digdirator",children:(0,s.jsx)(n.strong,{children:"Digdirator"})})," h\xe5ndterer klientregistrering mot Digdir sine fellesl\xf8sninger: ",(0,s.jsx)(n.strong,{children:"ID-porten"})," og ",(0,s.jsx)(n.strong,{children:"Maskinporten"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.a,{href:"https://github.com/nais/azurerator",children:(0,s.jsx)(n.strong,{children:"Azurerator"})})," h\xe5ndterer klientregistrering mot ",(0,s.jsx)(n.strong,{children:"Microsoft Entra ID"})," (tidligere kjent som Azure Active Directory)."]}),"\n"]}),"\n",(0,s.jsxs)(n.p,{children:["N\xe5r man skal registrere en klient mot en eller flere av identitetstilbyderne, har man tre valg.\nMan kan benytte seg av ",(0,s.jsx)(n.a,{href:"/docs/applikasjon-utrulling/skiperator/",children:"Skiperator"})," dersom klientregistreringen h\xf8rer til en SKIP-applikasjon.\nAlternativt kan man bruke CRD-ene fra ",(0,s.jsx)(n.a,{href:"https://github.com/nais/digdirator",children:"Digdirator"})," og ",(0,s.jsx)(n.a,{href:"https://github.com/nais/azurerator",children:"Azurerator"})," direkte."]}),"\n",(0,s.jsxs)(l.A,{queryString:"operator",children:[(0,s.jsxs)(o.A,{value:"skiperator",label:"Skiperator",children:[(0,s.jsxs)(n.p,{children:["Skiperator tilbyr et forenklet API i CRD-en ",(0,s.jsx)(n.code,{children:"Application"})," for \xe5 registrere klienter mot ",(0,s.jsx)(n.strong,{children:"ID-porten"})," og ",(0,s.jsx)(n.strong,{children:"Maskinporten"}),".\nDet jobbes ogs\xe5 med et forenklet API for \xe5 registrere klienter mot ",(0,s.jsx)(n.strong,{children:"Entra ID"}),", men dette er ikke helt klart enn\xe5."]}),(0,s.jsx)(n.p,{children:"Fordelen med \xe5 benytte Skiperator for klientregistrering er at hemmelighetene som Digdirator oppretter blir automatisk injisert som milj\xf8variabler i deploymenten til applikasjonen.\nDette gj\xf8r at applikasjonen enkelt kan f\xe5 tilgang til hemmelighetene i et kj\xf8retidsmilj\xf8."}),(0,s.jsxs)(l.A,{queryString:"idp",children:[(0,s.jsxs)(o.A,{value:"entraid",label:"Entra ID",children:[(0,s.jsx)(n.h3,{id:"-under-utvikling-",children:"\ud83d\udea7 UNDER UTVIKLING \ud83d\udea7"}),(0,s.jsxs)(n.p,{children:["Opprettelse av app-registrering i Entra ID via spesifikasjonen til ",(0,s.jsx)(n.code,{children:"Application"})," jobbes med, men er ikke klart helt enn\xe5."]})]}),(0,s.jsxs)(o.A,{value:"idporten",label:"ID-porten",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/docs/applikasjon-utrulling/skiperator/",children:"Skiperator"})," tilbyr st\xf8tte for \xe5 sette opp en klientintegrasjon mot ID-porten\nvia spesifikasjonen til ",(0,s.jsx)(n.code,{children:"Application"}),"."]}),(0,s.jsx)(n.p,{children:"Eksempelet under setter opp en integrasjon mot ID-porten med f\xf8lgende konfigurasjon."}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Integrasjonstypen settes til ",(0,s.jsx)(n.code,{children:"api_klient"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Redirect path settes til ",(0,s.jsx)(n.code,{children:"/oauth/callback"}),"."]}),"\n",(0,s.jsxs)(n.li,{children:["Scopene ",(0,s.jsx)(n.code,{children:"openid"})," og ",(0,s.jsx)(n.code,{children:"profile"})," settes."]}),"\n"]}),(0,s.jsxs)(n.p,{children:["Resten av feltene som st\xf8ttes kan du finne i Skiperator sin ",(0,s.jsx)(n.a,{href:"/docs/applikasjon-utrulling/skiperator/api-docs",children:"API-dokumentasjon"}),"."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: skiperator.kartverket.no/v1alpha1\nkind: Application\nmetadata:\n  name: application\n  namespace: tilgangsstyring-main\nspec:\n  image: image\n  port: 8080\n// diff-add-start\n  idporten:\n    enabled: true\n    integrationType: "api_klient"\n    redirectPath: "/oauth/callback"\n    scopes:\n      - "openid"\n      - "profile"\n// diff-add-end\n'})})]}),(0,s.jsxs)(o.A,{value:"maskinporten",label:"Maskinporten",children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)(n.a,{href:"/docs/applikasjon-utrulling/skiperator/",children:"Skiperator"})," tilbyr st\xf8tte for \xe5 sette opp en klientintegrasjon mot Maskinporten\nvia spesifikasjonen til ",(0,s.jsx)(n.code,{children:"Application"}),"."]}),(0,s.jsx)(n.p,{children:"Eksempelet under setter opp en integrasjon mot Maskinporten med f\xf8lgende konfigurasjon."}),(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Scopet ",(0,s.jsx)(n.code,{children:"innsyn"})," opprettes og organisasjonene HUSL\xd8S HURTIG TIGER AS og KOSTBAR LEKKER APE AS\nsettes som godkjente konsumenter av dette scopet."]}),"\n"]}),(0,s.jsxs)(n.p,{children:["Resten av feltene som st\xf8ttes kan du finne i Skiperator sin ",(0,s.jsx)(n.a,{href:"/docs/applikasjon-utrulling/skiperator/api-docs",children:"API-dokumentasjon"}),"."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: skiperator.kartverket.no/v1alpha1\nkind: Application\nmetadata:\n  name: application\n  namespace: tilgangsstyring-main\nspec:\n  image: image\n  port: 8080\n// diff-add-start\n  maskinporten:\n    enabled: true\n    scopes:\n      exposes:\n      - name: "innsyn"\n        enabled: true\n        product: "Produktomr\xe5de"\n        consumers:\n        - name: HUSL\xd8S HURTIG TIGER AS\n          orgno: "987654321"\n        - name: KOSTBAR LEKKER APE AS\n          orgno: "123456789"\n// diff-add-end\n'})})]})]})]}),(0,s.jsxs)(o.A,{value:"native",label:"Digdirator / Azurerator",children:[(0,s.jsx)(n.p,{children:"Hvis en \xf8nsker \xe5 opprette en klientintegrasjon uten \xe5 knytte den til en Skiperator-applikasjon, kan man benytte seg av CRD-ene som Digdirator og Azurerator introduserer direkte.\nDette gj\xf8r det mulig \xe5 opprette og vedlikeholde klientregistreringen uavhengig av en spesifikk applikasjon i Skiperator."}),(0,s.jsxs)(n.p,{children:["Fordelen med denne tiln\xe6rmingen er at man f\xe5r full kontroll over konfigurasjonen og stor fleksibilitet ved \xe5 frikoble registreringen fra applikasjonen.\nUlempen er at det krever mer innsikt i oppsettet, og at ",(0,s.jsx)(n.a,{href:"/docs/applikasjon-utrulling/skiperator/configuring#environment-variables",children:"injisering av hemmeligheter i deploymenten m\xe5 h\xe5ndteres separat"}),"."]}),(0,s.jsxs)(l.A,{queryString:"idp",children:[(0,s.jsxs)(o.A,{value:"entraid",label:"Entra ID",children:[(0,s.jsxs)(n.p,{children:["En kan registrere en klient mot Entra ID ved \xe5 opprette en ",(0,s.jsx)(n.code,{children:"AzureAdApplication"}),"-ressurs.\nRegistreringer opprettet med Azureator f\xf8lger f\xf8lgende navnekonvensjon basert p\xe5 ",(0,s.jsx)(n.code,{children:"AzureAdApplication"}),"-manifestet: ",(0,s.jsx)(n.code,{children:"cluster:namespace:name"}),"."]}),(0,s.jsxs)(n.h3,{id:"spesifikasjonen-til-azureadapplication",children:["Spesifikasjonen til ",(0,s.jsx)(n.code,{children:"AzureAdApplication"})]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"spec"})," ",(0,s.jsx)(n.em,{children:"(object, required)"})," \u2013 Spesifikasjon til ",(0,s.jsx)(n.code,{children:"AzureAdApplication"})]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"allowAllUsers"})," ",(0,s.jsx)(n.em,{children:"(bool, required)"})," \u2013 Bestemmer om alle brukere i tenanten som Azurerator er konfigurert mot skal f\xe5 tilgang."]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"claims"})," ",(0,s.jsx)(n.em,{children:"(object, optional)"})," \u2013 Definerer konfigurasjon av claims som inkluderes i tokenene som returneres til Entra ID applikasjonen."]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"groups"})," ",(0,s.jsx)(n.em,{children:"([]object, optional)"})," \u2013 En liste over Entra ID gruppe ID-er som skal inkluderes i ",(0,s.jsx)(n.code,{children:"groups"}),"-claimet i tokenene utstedt av Entra ID. Dette tildeler ogs\xe5 grupper til app-registreringen brukt for tilgangskontroll. Kun direkte medlemmer av gruppene f\xe5r tilgang."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"id"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 Objekt-ID-en (OID) til en Entra ID-gruppe."]})]})]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"replyUrls"})," ",(0,s.jsx)(n.em,{children:"([]object, required)"})," \u2013 URL-er som applikasjonen godtar som svaradresser etter autentisering."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"url"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 En godkjent svaradresse (reply URL) for applikasjonen."]})]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"logoutUrl"})," ",(0,s.jsx)(n.em,{children:"(string, optional)"})," \u2013 URL-en brukere blir omdirigert til n\xe5r de logger ut av applikasjonen.."]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"preAuthorizedApplications"})," ",(0,s.jsx)(n.em,{children:"([]object, optional)"})," \u2013 Definerer andre app-registreringer som er forh\xe5ndsautorisert til \xe5 f\xe5 tilgang til denne applikasjonen. Her refereres det til tilsvarende ",(0,s.jsx)(n.code,{children:"AzureAdApplication"}),"."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"application"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 Navnet p\xe5 den forh\xe5ndsgodkjente applikasjonen."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"namespace"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 Namespacet hvor den forh\xe5ndsgodkjente applikasjonen befinner seg."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"cluster"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 Clusteret hvor den forh\xe5ndsgodkjente applikasjonen befinner seg."]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"permissions"})," ",(0,s.jsx)(n.em,{children:"(object, optional)"})," \u2013 Spesifiserer hvilke claims den forh\xe5ndsautoriserte applikasjonen har."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"scopes"})," ",(0,s.jsx)(n.em,{children:"([]string, optional)"})," \u2013 Liste med egendefinerte tilgangs-scopes tildelt til den forh\xe5ndsautoriserte appliaksjonen."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"roles"})," ",(0,s.jsx)(n.em,{children:"([]string, optional)"})," \u2013 Liste med egendefinerte tilgangs-roller tildelt til den forh\xe5ndsautoriserte appliaksjonen."]})]})]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"secretName"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 Navnet p\xe5 den resulterende ",(0,s.jsx)(n.code,{children:"Secret"}),"-ressursen som vil bli opprettet."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"secretKeyPrefix"})," ",(0,s.jsx)(n.em,{children:"(string, optional)"})," \u2013 Et valgfritt brukerdefinert prefiks som brukes p\xe5 n\xf8klene i den genererte hemmeligheten, og erstatter standardprefikset (AZURE)."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"secretProtected"})," ",(0,s.jsx)(n.em,{children:"(bool, optional)"})," \u2013 Angir om hemmeligheten skal tilbaketrekkes selv n\xe5r den ikke er i bruk."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"singlePageApplication"})," ",(0,s.jsx)(n.em,{children:"(bool, optional)"})," \u2013 Angir om denne Entra ID-applikasjonen skal registreres som en single-page-application for bruk i klient-side-applikasjoner uten tilgang til hemmeligheter."]})]}),(0,s.jsx)(n.h3,{id:"eksempel",children:"Eksempel"}),(0,s.jsxs)(n.p,{children:["F\xf8lgende eksempel oppretter app-registreringen ",(0,s.jsx)(n.code,{children:"atgcp1-sandbox:tilgangsstyring-main:test-app"}),".\nDen gir kun tilgang til direkte medlemmer av gruppene med objekt-ID ",(0,s.jsx)(n.code,{children:"2720e397-081d-4d9b-852e-0d81f45a304f"})," eller ",(0,s.jsx)(n.code,{children:"c3c94454-aefc-44f9-9076-58ea47547941"}),".\nDen forh\xe5ndsautoriserer ogs\xe5 Entra ID klienten ",(0,s.jsx)(n.code,{children:"atgcp1-dev:other-namespace:other-app"}),".\nN\xe5r registrering er fullf\xf8rt vil Azurerator opprette Kubernetes-hemmeligheten ",(0,s.jsx)(n.code,{children:"entraid-secret"})," i namespacet ",(0,s.jsx)(n.code,{children:"tilgangsstyring-main"}),"."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: nais.io/v1\nkind: AzureAdApplication\nmetadata:\n  name: test-app\n  namespace: tilgangsstyring-main\nspec:\n  allowAllUsers: false\n  claims:\n    groups:\n      - id: 2720e397-081d-4d9b-852e-0d81f45a304f\n      - id: c3c94454-aefc-44f9-9076-58ea47547941\n  replyUrls:\n    - url: https://test-app.atgcp1-sandbox.kartverket-intern.cloud/oauth2/callback\n  preAuthorizedApplications:\n    - application: other-app\n      namespace: other-namespace\n      cluster: atgcp1-dev\n"})})]}),(0,s.jsxs)(o.A,{value:"idporten",label:"ID-porten",children:[(0,s.jsxs)(n.p,{children:["En kan registrere en klient mot ID-porten ved \xe5 opprette en ",(0,s.jsx)(n.code,{children:"IDPortenClient"}),"-ressurs."]}),(0,s.jsxs)(n.h3,{id:"spesifikasjonen-til-idportenclient",children:["Spesifikasjonen til ",(0,s.jsx)(n.code,{children:"IDPortenClient"})]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"spec"})," ",(0,s.jsx)(n.em,{children:"(object, required)"})," \u2013 Spesifikasjon til ",(0,s.jsx)(n.code,{children:"IDPortenClient"})]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"secretName"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 Navnet p\xe5 den resulterende ",(0,s.jsx)(n.code,{children:"Secret"}),"-ressursen som vil bli opprettet."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"integrationType"})," ",(0,s.jsx)(n.em,{children:"(string, optional)"})," \u2013 Definerer integrasjonstypen for klienten. Bestemmer hvilke scopes som kan registreres. Kan ikke endres etter opprettelse. Tillatte verdier: ",(0,s.jsx)(n.code,{children:"krr"}),", ",(0,s.jsx)(n.code,{children:"idporten"}),", ",(0,s.jsx)(n.code,{children:"api_klient"}),"."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"scopes"})," ",(0,s.jsx)(n.em,{children:"([]string, optional)"})," \u2013 Definerer OAuth2-scopes for klienten. Begrenset basert p\xe5 ",(0,s.jsx)(n.code,{children:"integrationType"}),"."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"frontchannelLogoutURI"})," ",(0,s.jsx)(n.em,{children:"(string, optional)"})," \u2013 URL som ID-porten omdirigere til n\xe5r en utlogging utl\xf8ses av en annen applikasjon."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"postLogoutRedirectURIs"})," ",(0,s.jsx)(n.em,{children:"([]string, optional)"})," \u2013 Liste over gyldige URI-er hvor ID-porten kan omdirigere etter utlogging."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"redirectURIs"})," ",(0,s.jsx)(n.em,{children:"([]string], optional)"})," \u2013 Liste over redirect URI-er som skal registreres hos DigDir."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"accessTokenLifetime"})," ",(0,s.jsx)(n.em,{children:"(integer, optional)"})," \u2013 Maksimal levetid i sekunder for ",(0,s.jsx)(n.code,{children:"access_token"})," som returneres fra ID-porten. Min: 1, maks: 3600."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"clientURI"})," ",(0,s.jsx)(n.em,{children:"(string, optional)"})," \u2013 URL til klienten brukt av DigDir n\xe5r en 'tilbake'-knapp vises eller ved feil."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"clientName"})," ",(0,s.jsx)(n.em,{children:"(string, optional)"})," \u2013 Navnet p\xe5 klienten registrert hos DigDir. Vises under innlogging for brukerorienterte flyter."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"sessionLifetime"})," ",(0,s.jsx)(n.em,{children:"(integer, optional)"})," \u2013 Maksimal \xf8ktlevetid i sekunder for en innlogget sluttbruker for denne klienten. Min: 3600, maks: 28800."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"ssoDisabled"})," ",(0,s.jsx)(n.em,{children:"(bool, optional)"})," \u2013 Kontrollerer Single Sign-On-oppsettet for klienten. Hvis satt til ",(0,s.jsx)(n.code,{children:"true"}),", er SSO deaktivert."]})]}),(0,s.jsx)(n.h3,{id:"eksempel-1",children:"Eksempel"}),(0,s.jsxs)(n.p,{children:["F\xf8lgende eksempel registrerer en klientintegrasjon mot ID-porten av typen ",(0,s.jsx)(n.code,{children:"idporten"}),".\nN\xe5r registrering er fullf\xf8rt vil Digdirator opprette Kubernetes-hemmeligheten ",(0,s.jsx)(n.code,{children:"idporten-secret"})," i namespacet ",(0,s.jsx)(n.code,{children:"tilgangsstyring-main"}),"."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:"apiVersion: nais.io/v1\nkind: IDPortenClient\nmetadata:\n  name: test-client\n  namespace: tilgansstyring-main\nspec:\n  clientName: Test Application\n  clientURI: https://test-app.atgcp1-sandbox.kartverket-intern.cloud\n  frontchannelLogoutURI: https://test-app.atgcp1-sandbox.kartverket-intern.cloud/oauth2/logout\n  integrationType: idporten\n  redirectURIs:\n  - https://test-app.atgcp1-sandbox.kartverket-intern.cloud/oauth2/callback\n  scopes:\n  - openid\n  - profile\n  secretName: idporten-secret\n"})})]}),(0,s.jsxs)(o.A,{value:"maskinporten",label:"Maskinporten",children:[(0,s.jsxs)(n.p,{children:["En kan registrere en klient mot Maskinporten ved \xe5 opprette en ",(0,s.jsx)(n.code,{children:"MaskinportenClient"}),"-ressurs."]}),(0,s.jsxs)(n.h3,{id:"spesifikasjonen-til-maskinportenclient",children:["Spesifikasjonen til ",(0,s.jsx)(n.code,{children:"MaskinportenClient"})]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"spec"})," ",(0,s.jsx)(n.em,{children:"(object, required)"})," \u2013 Spesifikasjon til ",(0,s.jsx)(n.code,{children:"MaskinportenClient"})]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"secretName"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 Navnet p\xe5 den resulterende ",(0,s.jsx)(n.code,{children:"Secret"}),"-ressursen som vil bli opprettet."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"clientName"})," ",(0,s.jsx)(n.em,{children:"(string, optional)"})," \u2013 Navnet p\xe5 klienten registrert hos DigDir. Vises under innlogging for brukerorienterte flyter, og er ellers en lesbar m\xe5te \xe5 skille mellom klienter i DigDirs selvbetjeningsportal."]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"scopes"})," ",(0,s.jsx)(n.em,{children:"([]object, optional)"})," \u2013 Definerer hvilke scopes applikasjonen konsumerer og hvilke den eksponerer."]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"consumes"})," ",(0,s.jsx)(n.em,{children:"([]object, optional)"})," \u2013 En liste med scopes din klient kan foresp\xf8rre tilgang til."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"name"})," ",(0,s.jsx)(n.em,{children:"(string, required)"})," \u2013 Scopene som applikasjonen konsumerer for \xe5 f\xe5 tilgang til en ekstern organisasjons API."]})]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"exposes"})," ",(0,s.jsx)(n.em,{children:"([]object, optional)"})," \u2013 En liste med scopes din applikasjon \xf8nsker \xe5 eksponere til andre organisasjoner hvor tilgang er basert p\xe5 organisasjonsnummer."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"enabled"})," ",(0,s.jsx)(n.em,{children:"(bool, required)"})," \u2013 Hvis ",(0,s.jsx)(n.code,{children:"true"}),", s\xe5 er detkonfigurerte scopet tilgjengelig for bruk og til \xe5 bli konsumert av organisasjoner som har f\xe5tt godkjent tilgang."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"name"})," ",(0,s.jsx)(n.em,{children:"(string, p\xe5krevd)"})," \u2013 Det faktiske sub-scopet kombinert med ",(0,s.jsx)(n.code,{children:"product"}),"."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"product"})," ",(0,s.jsx)(n.em,{children:"(string, valgfritt)"})," \u2013 Produktomr\xe5de tilknyttet scopet. Dette vil inkluderes i resultatet: ",(0,s.jsx)(n.code,{children:"org:<product><name>"}),"."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"atMaxAge"})," ",(0,s.jsx)(n.em,{children:"(int, valgfritt)"})," \u2013 Maksimal tillatt levetid for token i sekunder. Defaulter til 30 sekunder."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"allowedIntegrations"})," ",(0,s.jsx)(n.em,{children:"([]string, valgfritt)"})," \u2013 Liste over tillatte integrasjonstyper for dette eksponerte omfanget. Defaulter til ",(0,s.jsx)(n.code,{children:"maskinporten"}),"."]}),(0,s.jsxs)(r,{children:[(0,s.jsxs)("summary",{children:[(0,s.jsx)("strong",{children:"consumers"})," ",(0,s.jsx)(n.em,{children:"([]object, valgfritt)"})," \u2013 Liste over eksterne konsumenter som har tilgang til \xe5 konsumere dette scopet og som kan foresp\xf8rre ",(0,s.jsx)(n.code,{children:"access_token"}),"."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"orgno"})," \u2013 Det eksterne organisasjonsnummeret."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"name"})," \u2013 Beskrivende felt brukt utelukkende for oversikt."]})]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"accessibleForAll"})," \u2013 Tillater alle organisasjoner \xe5 f\xe5 tilgang til scopet."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"delegationSource"})," \u2013 Delegasjonskilde for scopet. Default er tomt, noe som betyr at ingen delegasjon er tillatt."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"separator"})," \u2013 Tegnet som skiller ",(0,s.jsx)(n.code,{children:"product"})," og ",(0,s.jsx)(n.code,{children:"name"})," i det endelige scopet. Resultatet blir da ",(0,s.jsx)(n.code,{children:"<prefix>:<product><separator><name>"}),". Defaulter til ",(0,s.jsx)(n.code,{children:":"})," med mindre ",(0,s.jsx)(n.code,{children:"name"})," inneholder ",(0,s.jsx)(n.code,{children:"/"}),", i det tilfellet defaultes det til ",(0,s.jsx)(n.code,{children:"/"}),"."]}),(0,s.jsxs)("p",{children:[(0,s.jsx)("strong",{children:"visibility"})," \u2013 Kontrollerer synligheten til scopet. Offentlige scopes er synlige for alle, mens private scopes kun er synlige for organisasjonen som eier scopet og organisasjoner som har f\xe5tt tilgang som konsumenter. Defaulter til ",(0,s.jsx)(n.code,{children:"public"}),". Tillatte verdier: ",(0,s.jsx)(n.code,{children:"private"}),", ",(0,s.jsx)(n.code,{children:"public"}),"."]})]})]})]}),(0,s.jsx)(n.h3,{id:"eksempel-2",children:"Eksempel"}),(0,s.jsxs)(n.p,{children:["F\xf8lgende eksempel registrerer en klientintegrasjon mot Maskinporten og definerer scopet ",(0,s.jsx)(n.code,{children:"innsyn"}),".\nDen setter HUSL\xd8S HURTIG TIGER AS og KOSTBAR LEKKER APE AS som godkjente konsumenter av scopet.\nN\xe5r registrering er fullf\xf8rt vil Digdirator opprette Kubernetes-hemmeligheten ",(0,s.jsx)(n.code,{children:"maskinporten-secret"})," i namespacet ",(0,s.jsx)(n.code,{children:"tilgangsstyring-main"}),"."]}),(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-yaml",children:'apiVersion: nais.io/v1\nkind: MaskinportenClient\nmetadata:\n  name: test-client\n  namespace: tilgangsstyring-main\nspec:\n  clientName: innsikt-secure-deltashare\n  scopes:\n    exposes:\n    - enabled: true\n      name: "innsyn"\n      product: "Produktomr\xe5de"\n      consumers:\n      - name: HUSL\xd8S HURTIG TIGER AS\n        orgno: "987654321"\n      - name: KOSTBAR LEKKER APE AS\n        orgno: "123456789"\n  secretName: maskinporten-secret\n'})})]})]})]})]})]})}function u(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(g,{...e})}):g(e)}},19365:(e,n,r)=>{r.d(n,{A:()=>l});r(96540);var t=r(34164);const s={tabItem:"tabItem_Ymn6"};var i=r(74848);function l(e){let{children:n,hidden:r,className:l}=e;return(0,i.jsx)("div",{role:"tabpanel",className:(0,t.A)(s.tabItem,l),hidden:r,children:n})}},11470:(e,n,r)=>{r.d(n,{A:()=>y});var t=r(96540),s=r(34164),i=r(23104),l=r(56347),o=r(205),a=r(57485),d=r(31682),c=r(70679);function p(e){return t.Children.toArray(e).filter((e=>"\n"!==e)).map((e=>{if(!e||(0,t.isValidElement)(e)&&function(e){const{props:n}=e;return!!n&&"object"==typeof n&&"value"in n}(e))return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)}))?.filter(Boolean)??[]}function g(e){const{values:n,children:r}=e;return(0,t.useMemo)((()=>{const e=n??function(e){return p(e).map((e=>{let{props:{value:n,label:r,attributes:t,default:s}}=e;return{value:n,label:r,attributes:t,default:s}}))}(r);return function(e){const n=(0,d.XI)(e,((e,n)=>e.value===n.value));if(n.length>0)throw new Error(`Docusaurus error: Duplicate values "${n.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`)}(e),e}),[n,r])}function u(e){let{value:n,tabValues:r}=e;return r.some((e=>e.value===n))}function h(e){let{queryString:n=!1,groupId:r}=e;const s=(0,l.W6)(),i=function(e){let{queryString:n=!1,groupId:r}=e;if("string"==typeof n)return n;if(!1===n)return null;if(!0===n&&!r)throw new Error('Docusaurus error: The <Tabs> component groupId prop is required if queryString=true, because this value is used as the search param name. You can also provide an explicit value such as queryString="my-search-param".');return r??null}({queryString:n,groupId:r});return[(0,a.aZ)(i),(0,t.useCallback)((e=>{if(!i)return;const n=new URLSearchParams(s.location.search);n.set(i,e),s.replace({...s.location,search:n.toString()})}),[i,s])]}function j(e){const{defaultValue:n,queryString:r=!1,groupId:s}=e,i=g(e),[l,a]=(0,t.useState)((()=>function(e){let{defaultValue:n,tabValues:r}=e;if(0===r.length)throw new Error("Docusaurus error: the <Tabs> component requires at least one <TabItem> children component");if(n){if(!u({value:n,tabValues:r}))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${n}" but none of its children has the corresponding value. Available values are: ${r.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);return n}const t=r.find((e=>e.default))??r[0];if(!t)throw new Error("Unexpected error: 0 tabValues");return t.value}({defaultValue:n,tabValues:i}))),[d,p]=h({queryString:r,groupId:s}),[j,m]=function(e){let{groupId:n}=e;const r=function(e){return e?`docusaurus.tab.${e}`:null}(n),[s,i]=(0,c.Dv)(r);return[s,(0,t.useCallback)((e=>{r&&i.set(e)}),[r,i])]}({groupId:s}),k=(()=>{const e=d??j;return u({value:e,tabValues:i})?e:null})();(0,o.A)((()=>{k&&a(k)}),[k]);return{selectedValue:l,selectValue:(0,t.useCallback)((e=>{if(!u({value:e,tabValues:i}))throw new Error(`Can't select invalid tab value=${e}`);a(e),p(e),m(e)}),[p,m,i]),tabValues:i}}var m=r(92303);const k={tabList:"tabList__CuJ",tabItem:"tabItem_LNqP"};var x=r(74848);function f(e){let{className:n,block:r,selectedValue:t,selectValue:l,tabValues:o}=e;const a=[],{blockElementScrollPositionUntilNextRender:d}=(0,i.a_)(),c=e=>{const n=e.currentTarget,r=a.indexOf(n),s=o[r].value;s!==t&&(d(n),l(s))},p=e=>{let n=null;switch(e.key){case"Enter":c(e);break;case"ArrowRight":{const r=a.indexOf(e.currentTarget)+1;n=a[r]??a[0];break}case"ArrowLeft":{const r=a.indexOf(e.currentTarget)-1;n=a[r]??a[a.length-1];break}}n?.focus()};return(0,x.jsx)("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,s.A)("tabs",{"tabs--block":r},n),children:o.map((e=>{let{value:n,label:r,attributes:i}=e;return(0,x.jsx)("li",{role:"tab",tabIndex:t===n?0:-1,"aria-selected":t===n,ref:e=>{a.push(e)},onKeyDown:p,onClick:c,...i,className:(0,s.A)("tabs__item",k.tabItem,i?.className,{"tabs__item--active":t===n}),children:r??n},n)}))})}function v(e){let{lazy:n,children:r,selectedValue:i}=e;const l=(Array.isArray(r)?r:[r]).filter(Boolean);if(n){const e=l.find((e=>e.props.value===i));return e?(0,t.cloneElement)(e,{className:(0,s.A)("margin-top--md",e.props.className)}):null}return(0,x.jsx)("div",{className:"margin-top--md",children:l.map(((e,n)=>(0,t.cloneElement)(e,{key:n,hidden:e.props.value!==i})))})}function b(e){const n=j(e);return(0,x.jsxs)("div",{className:(0,s.A)("tabs-container",k.tabList),children:[(0,x.jsx)(f,{...n,...e}),(0,x.jsx)(v,{...n,...e})]})}function y(e){const n=(0,m.A)();return(0,x.jsx)(b,{...e,children:p(e.children)},String(n))}},28453:(e,n,r)=>{r.d(n,{R:()=>l,x:()=>o});var t=r(96540);const s={},i=t.createContext(s);function l(e){const n=t.useContext(i);return t.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),t.createElement(i.Provider,{value:n},e.children)}}}]);