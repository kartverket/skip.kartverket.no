"use strict";(self.webpackChunkskip_docs=self.webpackChunkskip_docs||[]).push([[4966],{11730:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>b,frontMatter:()=>t,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"jobber-skip/index","title":"\ud83d\udcc5 Jobber p\xe5 SKIP","description":"SKIP tilbyr abstraksjonen SKIPJob for \xe5 kunne kj\xf8re programmer \xe9n gang (\\"one-off\\") eller periodisk (kjent som \\"cron jobs\\").","source":"@site/docs/04-jobber-skip/index.md","sourceDirName":"04-jobber-skip","slug":"/jobber-skip/","permalink":"/docs/jobber-skip/","draft":false,"unlisted":false,"editUrl":"https://github.com/kartverket/skip-docs/edit/main/docs/04-jobber-skip/index.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Kom i gang med Argokit","permalink":"/docs/applikasjon-utrulling/argokit/getting-started"},"next":{"title":"\ud83d\udea6 Trafikkstyring","permalink":"/docs/trafikkstyring/"}}');var i=r(74848),s=r(28453);const t={},a="\ud83d\udcc5 Jobber p\xe5 SKIP",l={},d=[{value:"Konfigurere en SKIPJob",id:"konfigurere-en-skipjob",level:2},{value:"One-off jobb",id:"one-off-jobb",level:3},{value:"Cron jobb (periodisk)",id:"cron-jobb-periodisk",level:3},{value:"Kompleks jobb",id:"kompleks-jobb",level:3},{value:"Trigge en jobb",id:"trigge-en-jobb",level:2}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",img:"img",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"-jobber-p\xe5-skip",children:"\ud83d\udcc5 Jobber p\xe5 SKIP"})}),"\n",(0,i.jsxs)(n.p,{children:["SKIP tilbyr abstraksjonen ",(0,i.jsx)(n.code,{children:"SKIPJob"}),' for \xe5 kunne kj\xf8re programmer \xe9n gang ("one-off") eller periodisk (kjent som "cron jobs").\nDette dokumentet hjelper deg med \xe5 ta i bruk jobber p\xe5 SKIP.']}),"\n",(0,i.jsx)(n.h2,{id:"konfigurere-en-skipjob",children:"Konfigurere en SKIPJob"}),"\n",(0,i.jsxs)(n.p,{children:["En SKIPJob konfigureres i stor grad likt som applikasjoner.\nInbound access policy og port skal derimot ",(0,i.jsx)(n.em,{children:"ikke"})," konfigureres for jobber.\nMer info om vanlig konfiguration av applikasjoner finner du ",(0,i.jsx)(n.a,{href:"/docs/applikasjon-utrulling/skiperator/configuring",children:"her"}),"."]}),"\n",(0,i.jsx)(n.h3,{id:"one-off-jobb",children:"One-off jobb"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: skiperator.kartverket.no/v1alpha1\nkind: SKIPJob\nmetadata:\n  name: min-jobb\nspec:\n  container:\n    image: "ghcr.io/kartverket/min-jobb:latest"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Denne vil kj\xf8re docker imaget ",(0,i.jsx)(n.code,{children:"min-jobb:latest"})," en gang.\nDen vil kj\xf8re hver gang den blir syncet i ArgoCD."]}),"\n",(0,i.jsx)(n.h3,{id:"cron-jobb-periodisk",children:"Cron jobb (periodisk)"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: skiperator.kartverket.no/v1alpha1\nkind: SKIPJob\nmetadata:\n  name: min-cron-jobb\nspec:\n  container:\n    image: "ghcr.io/kartverket/min-jobb:latest"\n  cron:\n    schedule: "0 * * * *"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Denne vil kj\xf8re docker imaget ",(0,i.jsx)(n.code,{children:"min-jobb:latest"})," \xe9n gang hver time. For \xe5 finne et passende cron-uttrykk anbefales ",(0,i.jsx)(n.a,{href:"https://crontab.guru/",children:"Crontab Guru"}),".\n",(0,i.jsx)(n.strong,{children:"NB:"})," Alle jobber vil kj\xf8re i UTC-tidssonen, med mindre feltet ",(0,i.jsx)(n.code,{children:"timeZone"})," er spesifisert."]}),"\n",(0,i.jsx)(n.h3,{id:"kompleks-jobb",children:"Kompleks jobb"}),"\n",(0,i.jsxs)(n.p,{children:["I dette eksempelet konfigureres en jobb som har tilgang til \xe5 aksessere ressurser i GCP (f.eks. Blob Storage) og som er avhengig av \xe5 prate med applikasjonen ",(0,i.jsx)(n.code,{children:"min-applikasjon"})," i samme namespace.\nJobben kj\xf8rer ukedager (mandag-fredag) kl 21:30 i gjeldende tidssone for Norge."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'apiVersion: skiperator.kartverket.no/v1alpha1\nkind: SKIPJob\nmetadata:\n  name: min-cron-jobb\nspec:\n  cron:\n    schedule: "30 21 * * 1-5"\n    timeZone: "Europe/Oslo"\n  container:\n    image: "ghcr.io/kartverket/min-jobb:latest"\n    gcp:\n      auth:\n        serviceAccount: "min-jobb@mitt-prosjekt.iam.gserviceaccount.com"\n    accessPolicy:\n      outbound:\n        rules:\n          - application: "min-applikasjon"\n    env:\n      - name: MIN_ENV_VAR\n        value: "min-env-value"\n    envFrom:\n      - secret: "secret-navn"\n'})}),"\n",(0,i.jsx)(n.h2,{id:"trigge-en-jobb",children:"Trigge en jobb"}),"\n",(0,i.jsxs)(n.p,{children:["Spesielt for one-off jobber er det aktuelt \xe5 trigge jobben manuelt uten at du har gjort endringer.\nVi har ingen pen m\xe5te \xe5 trigge jobber p\xe5 enn\xe5, men du kan likevel trigge en jobb ved \xe5 g\xe5 inn i argo og slette ",(0,i.jsx)(n.code,{children:"Job"})," ressursen (",(0,i.jsx)(n.em,{children:"ikke"})," ",(0,i.jsx)(n.code,{children:"SKIPJob"}),").\n",(0,i.jsx)(n.img,{alt:"Trigge en jobb",src:r(38258).A+"",width:"1046",height:"336"}),'\nTrykk p\xe5 "Delete", velg "Foreground Delete" (default) og trykk "Ok" s\xe5 vil ',(0,i.jsx)(n.code,{children:"Job"})," ressursen opprettes p\xe5 nytt og jobben kj\xf8res."]}),"\n",(0,i.jsx)(n.p,{children:'For \xe5 trigge cron jobber manuelt kan du trykke p\xe5 kebab meny knappen p\xe5 "cronjob" ressursen og velge "Create Job".'}),"\n",(0,i.jsxs)(n.p,{children:["Ved \xe5 sette ",(0,i.jsx)(n.a,{href:"/docs/applikasjon-utrulling/skiperator/api-docs#skipjobspeccron",children:(0,i.jsx)(n.code,{children:".spec.job.cron.suspend = true"})})," kan du hindre en cron jobb fra \xe5 kj\xf8re periodisk og den kan dermed trigges manuelt via kebab meny.\nSKIPJoben vil da oppf\xf8re seg som en one-off jobb, men den vil ikke kj\xf8re n\xe5r den synces."]})]})}function b(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}},28453:(e,n,r)=>{r.d(n,{R:()=>t,x:()=>a});var o=r(96540);const i={},s=o.createContext(i);function t(e){const n=o.useContext(s);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:t(e.components),o.createElement(s.Provider,{value:n},e.children)}},38258:(e,n,r)=>{r.d(n,{A:()=>o});const o=r.p+"assets/images/slett_skipjob-18345d8155f6c099d266002b0ea6f445.png"}}]);