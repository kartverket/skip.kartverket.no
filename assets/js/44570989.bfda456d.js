"use strict";(self.webpackChunkskip_docs=self.webpackChunkskip_docs||[]).push([[6895],{15389:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>l,default:()=>c,frontMatter:()=>s,metadata:()=>i,toc:()=>g});const i=JSON.parse('{"id":"applikasjon-utrulling/github-actions/tilgang-til-interne-pakker-fra-github-actions","title":"Tilgang til interne pakker fra GitHub Actions","description":"N\xe5r man jobber med avhengigheter til interne pakker i organisasjonen kan det v\xe6re n\xf8dvendig \xe5 f\xe5 tilgang til disse fra GitHub Actions. Dette er spesielt aktuelt n\xe5r man bygger applikasjoner som avhenger av interne biblioteker eller pakker som ikke er publisert offentlig.","source":"@site/docs/03-applikasjon-utrulling/08-github-actions/11-tilgang-til-interne-pakker-fra-github-actions.md","sourceDirName":"03-applikasjon-utrulling/08-github-actions","slug":"/applikasjon-utrulling/github-actions/tilgang-til-interne-pakker-fra-github-actions","permalink":"/docs/applikasjon-utrulling/github-actions/tilgang-til-interne-pakker-fra-github-actions","draft":false,"unlisted":false,"editUrl":"https://github.com/kartverket/skip-docs/edit/main/docs/03-applikasjon-utrulling/08-github-actions/11-tilgang-til-interne-pakker-fra-github-actions.md","tags":[],"version":"current","sidebarPosition":11,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Transitive avhengigheter i Dependency Graph med Gradle","permalink":"/docs/applikasjon-utrulling/github-actions/gradle-dependency-graph"},"next":{"title":"Tilgang til repoer med tokens fra GitHub Actions","permalink":"/docs/applikasjon-utrulling/github-actions/tilgang-til-repoer-med-tokens-fra-github-actions"}}');var r=t(74848),a=t(28453);const s={},l="Tilgang til interne pakker fra GitHub Actions",o={},g=[{value:"Bakgrunn",id:"bakgrunn",level:2},{value:"Slik f\xe5r repoet ditt tilgang",id:"slik-f\xe5r-repoet-ditt-tilgang",level:2},{value:"1. Legg til topic p\xe5 repoet",id:"1-legg-til-topic-p\xe5-repoet",level:3},{value:"2. Kj\xf8r Terraform-workflow",id:"2-kj\xf8r-terraform-workflow",level:3},{value:"3. Bruk tokenet i workflows",id:"3-bruk-tokenet-i-workflows",level:3},{value:"Eksempel: Environment-variabel",id:"eksempel-environment-variabel",level:4},{value:"Eksempel: Send inn til en action",id:"eksempel-send-inn-til-en-action",level:4}];function p(e){const n={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",img:"img",p:"p",pre:"pre",...(0,a.R)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.header,{children:(0,r.jsx)(n.h1,{id:"tilgang-til-interne-pakker-fra-github-actions",children:"Tilgang til interne pakker fra GitHub Actions"})}),"\n",(0,r.jsx)(n.p,{children:"N\xe5r man jobber med avhengigheter til interne pakker i organisasjonen kan det v\xe6re n\xf8dvendig \xe5 f\xe5 tilgang til disse fra GitHub Actions. Dette er spesielt aktuelt n\xe5r man bygger applikasjoner som avhenger av interne biblioteker eller pakker som ikke er publisert offentlig."}),"\n",(0,r.jsx)(n.h2,{id:"bakgrunn",children:"Bakgrunn"}),"\n",(0,r.jsx)(n.p,{children:"GitHub tilbyr ikke en optimal mekanisme for \xe5 dele interne pakker p\xe5 tvers av repoer i en organisasjon. Dette har f\xf8rt til at utviklerne i ulike team m\xe5 opprette egne PAT's manuelt, og disse blir liggende rundt om kring i ulike repoer til de utl\xf8per."}),"\n",(0,r.jsx)(n.p,{children:"Vi har vurdert og besluttet at en pragmatisk l\xf8sning er \xe5 tilby en secret p\xe5 organisasjonsniv\xe5 som gir lesetilgang til pakker internt. Dette er en melloml\xf8sning i p\xe5vente av bedre mekanismer fra GitHub."}),"\n",(0,r.jsx)(n.admonition,{type:"info",children:(0,r.jsx)(n.p,{children:"Tokenet gir kun lesetilgang til pakker i organisasjonen, og skal ikke brukes til andre form\xe5l."})}),"\n",(0,r.jsx)(n.h2,{id:"slik-f\xe5r-repoet-ditt-tilgang",children:"Slik f\xe5r repoet ditt tilgang"}),"\n",(0,r.jsx)(n.p,{children:"For \xe5 f\xe5 tilgang til secreten med tokenet for henting av interne pakker m\xe5 du gj\xf8re f\xf8lgende:"}),"\n",(0,r.jsx)(n.h3,{id:"1-legg-til-topic-p\xe5-repoet",children:"1. Legg til topic p\xe5 repoet"}),"\n",(0,r.jsxs)(n.p,{children:["Legg til topic ",(0,r.jsx)(n.code,{children:"needs-packages"})," p\xe5 GitHub-repoet ditt. Dette gj\xf8res ved \xe5 g\xe5 til repo-innstillingene p\xe5 GitHub.\n",(0,r.jsx)(n.img,{alt:"Legg til topic",src:t(93030).A+"",width:"519",height:"290"})]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Legg til topic steg 2",src:t(43975).A+"",width:"641",height:"526"})}),"\n",(0,r.jsx)(n.h3,{id:"2-kj\xf8r-terraform-workflow",children:"2. Kj\xf8r Terraform-workflow"}),"\n",(0,r.jsxs)(n.p,{children:["N\xe5r topic er lagt til m\xe5 du kj\xf8re Terraform-workflowen i ",(0,r.jsx)(n.a,{href:"https://github.com/kartverket/github-iac/actions/workflows/shared_package_repos.yaml",children:"github-iac"})," for \xe5 oppdatere tilgangene. Dette s\xf8rger for at repoet ditt f\xe5r tilgang til tokenet som en secret fra organisasjonen."]}),"\n",(0,r.jsx)(n.p,{children:"Workflowen kj\xf8res ogs\xe5 automatisk en gang daglig kl 12 for \xe5 fange opp nye repoer og fjerne tilgang fra repoer som ikke lenger har topicen."}),"\n",(0,r.jsxs)(n.p,{children:["N\xe5r workflowen har kj\xf8rt kan du verifisere at repoet ditt har f\xe5tt tilgang ved \xe5 g\xe5 til ",(0,r.jsx)(n.code,{children:"Settings"})," -> ",(0,r.jsx)(n.code,{children:"Secrets and variables"})," -> ",(0,r.jsx)(n.code,{children:"Actions"})," i repoet ditt. Der skal du se en secret med navnet ",(0,r.jsx)(n.code,{children:"SHARED_PACKAGES_READ_TOKEN"}),"."]}),"\n",(0,r.jsx)(n.p,{children:(0,r.jsx)(n.img,{alt:"Verifiser secret",src:t(49588).A+"",width:"1158",height:"334"})}),"\n",(0,r.jsx)(n.h3,{id:"3-bruk-tokenet-i-workflows",children:"3. Bruk tokenet i workflows"}),"\n",(0,r.jsxs)(n.p,{children:["Etter at tilgangen er p\xe5 plass kan du bruke tokenet i dine GitHub Actions workflows. Organization secret heter ",(0,r.jsx)(n.code,{children:"SHARED_PACKAGES_READ_TOKEN"})," og kan brukes som en environment-variabel eller sendes inn til actions etter behov."]}),"\n",(0,r.jsx)(n.p,{children:"Hvordan du bruker tokenet avhenger av byggemilj\xf8et og verkt\xf8yene du benytter. Her er noen eksempler:"}),"\n",(0,r.jsx)(n.h4,{id:"eksempel-environment-variabel",children:"Eksempel: Environment-variabel"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"jobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v5\n      \n      - name: Build with access to internal packages\n        env:\n          PACKAGES_TOKEN: ${{ secrets.SHARED_PACKAGES_READ_TOKEN }}\n        run: |\n          # Bruk tokenet til \xe5 autentisere mot pakkeregisteret\n          # Eksempel avhenger av pakkemanager (npm, maven, etc.)\n"})}),"\n",(0,r.jsx)(n.h4,{id:"eksempel-send-inn-til-en-action",children:"Eksempel: Send inn til en action"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-yaml",children:"jobs:\n  build:\n    runs-on: ubuntu-latest\n    steps:\n      - uses: actions/checkout@v5\n      \n      - name: Setup with package access\n        uses: some-action@v1\n        with:\n          token: ${{ secrets.SHARED_PACKAGES_READ_TOKEN }}\n"})}),"\n",(0,r.jsx)(n.admonition,{type:"tip",children:(0,r.jsx)(n.p,{children:"Husk \xe5 slette eventuelle gamle PAT's opprettet p\xe5 din personlige konto n\xe5r du har bekreftet at alt fungerer med det nye tokenet."})})]})}function c(e={}){const{wrapper:n}={...(0,a.R)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(p,{...e})}):p(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>l});var i=t(96540);const r={},a=i.createContext(r);function s(e){const n=i.useContext(a);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(r):e.components||r:s(e.components),i.createElement(a.Provider,{value:n},e.children)}},43975:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/repo-topic-details-c09c3c5c48dff946b0eecc37438158ae.png"},49588:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/repo-org-secret-c1465e06125612de8774f6f0ee17ae28.png"},93030:(e,n,t)=>{t.d(n,{A:()=>i});const i=t.p+"assets/images/repo-topic-e6a6f3f1e54af9c979264485de39ea32.png"}}]);