"use strict";(self.webpackChunkskip_docs=self.webpackChunkskip_docs||[]).push([[5942],{28453:(e,n,r)=>{r.d(n,{R:()=>a,x:()=>o});var s=r(96540);const i={},t=s.createContext(i);function a(e){const n=s.useContext(t);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function o(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),s.createElement(t.Provider,{value:n},e.children)}},71216:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>l,contentTitle:()=>o,default:()=>c,frontMatter:()=>a,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"kom-i-gang/praktisk-intro/github/dependabot","title":"Dependabot","description":"Dependabot benytter GitHub dependency graph","source":"@site/docs/02-kom-i-gang/06-praktisk-intro/01-github/06-dependabot.md","sourceDirName":"02-kom-i-gang/06-praktisk-intro/01-github","slug":"/kom-i-gang/praktisk-intro/github/dependabot","permalink":"/docs/kom-i-gang/praktisk-intro/github/dependabot","draft":false,"unlisted":false,"editUrl":"https://github.com/kartverket/skip-docs/edit/main/docs/02-kom-i-gang/06-praktisk-intro/01-github/06-dependabot.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Bruk av GitHub med Jenkins","permalink":"/docs/kom-i-gang/praktisk-intro/github/bruk-av-github-med-jenkins"},"next":{"title":"\u2699\ufe0f Kubernetes","permalink":"/docs/kom-i-gang/praktisk-intro/kubernetes/"}}');var i=r(74848),t=r(28453);const a={},o="Dependabot",l={},d=[{value:"Skru p\xe5 automatiske versjonsoppdateringer",id:"skru-p\xe5-automatiske-versjonsoppdateringer",level:2},{value:"Feils\xf8king av Dependabot",id:"feils\xf8king-av-dependabot",level:2},{value:"Konfigurasjon av Dependabot",id:"konfigurasjon-av-dependabot",level:2},{value:"Begrense antallet pull requests fra Dependabot",id:"begrense-antallet-pull-requests-fra-dependabot",level:3},{value:"Oppdateringsintervall",id:"oppdateringsintervall",level:3},{value:"Innlogging til private registries",id:"innlogging-til-private-registries",level:3},{value:"NPM",id:"npm",level:4},{value:"GitHub",id:"github",level:4},{value:"Maven",id:"maven",level:4},{value:"Eksempelkonfigurasjoner",id:"eksempelkonfigurasjoner",level:2},{value:"GitHub Actions",id:"github-actions",level:3},{value:"Git submodules",id:"git-submodules",level:3},{value:"Docker",id:"docker",level:3},{value:"Gradle",id:"gradle",level:3},{value:"NPM eksempel",id:"npm-eksempel",level:3},{value:"Go",id:"go",level:3},{value:"Terraform",id:"terraform",level:3},{value:"Python",id:"python",level:3}];function p(e){const n={a:"a",code:"code",h1:"h1",h2:"h2",h3:"h3",h4:"h4",header:"header",p:"p",pre:"pre",...(0,t.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"dependabot",children:"Dependabot"})}),"\n",(0,i.jsxs)(n.p,{children:["Dependabot benytter ",(0,i.jsx)(n.a,{href:"https://docs.github.com/en/code-security/supply-chain-security/understanding-your-software-supply-chain/about-the-dependency-graph",children:"GitHub dependency graph"}),"\nfor \xe5 gi beskjed om s\xe5rbare avhengigheter, samt oppgradering av disse. Dette er skrudd p\xe5 automatisk for alle GitHub-repoer. I tillegg kan det skrus p\xe5 automatiske\nversjonsoppdateringer med Dependabot, slik at Dependabot lager PR-er for nye versjoner for spr\xe5k/\xf8kosystem som er aktivert."]}),"\n",(0,i.jsx)(n.h2,{id:"skru-p\xe5-automatiske-versjonsoppdateringer",children:"Skru p\xe5 automatiske versjonsoppdateringer"}),"\n",(0,i.jsx)(n.p,{children:'Automatiske versjonsoppdateringer m\xe5 skrus p\xe5 av en bruker med "Admin"-rolle i repoet. For det aktuelle repoet kan du g\xe5 til\n"Settings > Code security > Dependabot > Dependabot version updates" og trykke p\xe5 "Enable".'}),"\n",(0,i.jsxs)(n.p,{children:["Dersom dette ikke er gjort fra f\xf8r m\xe5 du sette opp en initiell versjon av filen ",(0,i.jsx)(n.code,{children:".github/dependabot.yml"}),". Det er anbefalt \xe5 sette opp for oppdatering av GitHub Actions for\nalle repoer som et minimum:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'version: 2\nupdates:\n  - package-ecosystem: "github-actions"\n    directory: ".github/workflows"\n    schedule:\n      interval: "daily"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["I tillegg b\xf8r det settes opp for de ulike spr\xe5kene/\xf8kosystemene som ligger i repoet. Se eksemplene i avsnittet ",(0,i.jsx)(n.a,{href:"#eksempelkonfigurasjoner",children:"Eksempelkonfigurasjoner"}),"."]}),"\n",(0,i.jsx)(n.h2,{id:"feils\xf8king-av-dependabot",children:"Feils\xf8king av Dependabot"}),"\n",(0,i.jsx)(n.p,{children:'For \xe5 se Dependabot-feil i et repo kan man g\xe5 til "Insights > Dependency graph > Dependabot" for \xe5 se feil, status og logger fra siste kj\xf8ringer.'}),"\n",(0,i.jsxs)(n.p,{children:["Se ogs\xe5 ",(0,i.jsx)(n.a,{href:"https://docs.github.com/en/code-security/dependabot/troubleshooting-dependabot",children:"GitHub-dokumentasjonen"})," for mer detaljert beskrivelse av feils\xf8king."]}),"\n",(0,i.jsx)(n.h2,{id:"konfigurasjon-av-dependabot",children:"Konfigurasjon av Dependabot"}),"\n",(0,i.jsx)(n.h3,{id:"begrense-antallet-pull-requests-fra-dependabot",children:"Begrense antallet pull requests fra Dependabot"}),"\n",(0,i.jsxs)(n.p,{children:["Antallet PR-er er begrenset til 5 for vanlige versjonsoppdateringer og 10 for sikkerhetsoppdateringer. Antallet \xe5pne PR-er kan konfigureres med ",(0,i.jsx)(n.code,{children:"open-pull-requests-limit"})," for\nhvert \xf8kosystem. F.eks.:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "<ecosystem>"\n    open-pull-requests-limit: 20\n    # ... More config ... \n'})}),"\n",(0,i.jsx)(n.h3,{id:"oppdateringsintervall",children:"Oppdateringsintervall"}),"\n",(0,i.jsxs)(n.p,{children:["Man kan styre Dependabot kj\xf8rer ved \xe5 konfigurere ",(0,i.jsx)(n.code,{children:"schedule"})," for hvert ",(0,i.jsx)(n.code,{children:"package-ecosystem"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"For \xe5 kj\xf8re oppdateringer hver morgen i ukedagene:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "pip"\n    directory: "/"\n    schedule:\n      interval: "daily"\n      time: "07:00"\n      timezone: "Europe/Oslo"\n'})}),"\n",(0,i.jsx)(n.p,{children:"For \xe5 kj\xf8re oppdateringer hver mandag morgen:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "pip"\n    directory: "/"\n    schedule:\n      interval: "weekly"\n      day: "monday"\n      time: "07:00"\n      timezone: "Europe/Oslo"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"innlogging-til-private-registries",children:"Innlogging til private registries"}),"\n",(0,i.jsx)(n.p,{children:"For at Dependabot skal kunne oppdatere dependencies som ligger i private/internal repoer (eks. actions), pakker i private package registries (npm, maven) elle"}),"\n",(0,i.jsx)(n.p,{children:"Merk at dette krever PATs eller access tokens som m\xe5 ligge som en Dependabot repository secret i repoet."}),"\n",(0,i.jsxs)(n.p,{children:["Private registries m\xe5 legges i ",(0,i.jsx)(n.code,{children:"registries"}),"-listen, og m\xe5 i tillegg refereres til i ",(0,i.jsx)(n.code,{children:"updates"}),"-listen for relevante \xf8kosystemer. Eks.:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"version: 2\nregistries:\n  npm-github:\n    type: npm-registry\n    url: https://npm.pkg.github.com\n    token: ${{ secrets.PAT_GHCR_READ }}\nupdates:\n  - package-ecosystem: npm\n    # Check also for updates in GitHub Maven Package frontend-aut-lib\n    registries:\n      - npm-github\n    # Remaining configuration skipped\n"})}),"\n",(0,i.jsx)(n.h4,{id:"npm",children:"NPM"}),"\n",(0,i.jsxs)(n.p,{children:["Se ogs\xe5 ",(0,i.jsx)(n.a,{href:"https://docs.github.com/en/code-security/dependabot/working-with-dependabot/configuring-access-to-private-registries-for-dependabot#npm-registry",children:"dokumentasjonen"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"registries:\n  npm-github:\n    type: npm-registry\n    url: https://npm.pkg.github.com\n    token: ${{ secrets.PAT_GHCR_READ }}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"github",children:"GitHub"}),"\n",(0,i.jsxs)(n.p,{children:["Denne brukes typisk for actions som ligger i private/interne repoer. Dependabot m\xe5 bli gitt eksplisitt tilgang for \xe5 lese nye private/interne repoer\n(sp\xf8r om hjelp i ",(0,i.jsx)(n.code,{children:"#gen-github"})," p\xe5 Slack). Se ogs\xe5 ",(0,i.jsx)(n.a,{href:"https://docs.github.com/en/code-security/dependabot/working-with-dependabot/configuring-access-to-private-registries-for-dependabot#git",children:"dokumentasjonen"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"registries:\n  github-repo-name:\n    type: git\n    url: https://github.com\n    username: x-access-token\n    password: ${{ secrets.PAT_READ_REPO_NAME }}\n"})}),"\n",(0,i.jsx)(n.h4,{id:"maven",children:"Maven"}),"\n",(0,i.jsxs)(n.p,{children:["Denne brukes for \xe5 lese Maven-pakker som er publisert i et gitt repo. Se ogs\xe5 ",(0,i.jsx)(n.a,{href:"https://docs.github.com/en/code-security/dependabot/working-with-dependabot/configuring-access-to-private-registries-for-dependabot#maven-repository",children:"dokumentasjonen"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:"registries:\n  maven-repo-name:\n    type: maven-repository\n    url: https://maven.pkg.github.com/kartverket/repo-name\n    username: ${{ secrets.GH_USERNAME }}\n    password: ${{ secrets.PAT_GHCR_READ }}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"eksempelkonfigurasjoner",children:"Eksempelkonfigurasjoner"}),"\n",(0,i.jsxs)(n.p,{children:["De ulike \xf8kosystemene fungerer litt ulikt, og st\xf8tte kan variere. For mer informasjon se ",(0,i.jsx)(n.a,{href:"https://docs.github.com/en/code-security/dependabot/ecosystems-supported-by-dependabot/supported-ecosystems-and-repositories",children:"dokumentasjonen for \xf8kosystemer"}),"."]}),"\n",(0,i.jsx)(n.p,{children:"Under f\xf8lger noen vanlige konfigurasjoner som flere team bruker. Disse er et gir et godt utgangspunkt men m\xe5 i noen tilfeller konfigureres mer for \xe5 fungere."}),"\n",(0,i.jsx)(n.h3,{id:"github-actions",children:"GitHub Actions"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "github-actions"\n    directory: ".github/workflows"\n    schedule:\n      interval: "daily"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"git-submodules",children:"Git submodules"}),"\n",(0,i.jsx)(n.p,{children:"Denne kan legges til i repoer som bruker git submodules, eks. apps-repoer som benytter argokit."}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "gitsubmodule"\n    directory: "/"\n    schedule:\n      interval: "daily"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"docker",children:"Docker"}),"\n",(0,i.jsxs)(n.p,{children:["Pass p\xe5 at ",(0,i.jsx)(n.code,{children:"directory"})," peker til mappen som inneholder ",(0,i.jsx)(n.code,{children:"Dockerfile"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "docker"\n    directory: "/"\n    schedule:\n      interval: "daily"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"gradle",children:"Gradle"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "gradle"\n    directory: "/"\n    schedule:\n      interval: "daily"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"npm-eksempel",children:"NPM eksempel"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "npm"\n    directory: "/"\n    schedule:\n      interval: "weekly"\n'})}),"\n",(0,i.jsx)(n.p,{children:"For \xe5 unng\xe5 for mange PR-er for minor- og patchversjoner er det i mange tilfeller ok \xe5 gruppere disse for NPM:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "npm"\n    directory: "/"\n    schedule:\n      interval: "weekly"\n    groups:\n      minor-and-patch-dependencies:\n        patterns:\n          - "*"\n        update-types:\n          - "minor"\n          - "patch"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"go",children:"Go"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "gomod"\n    directory: "/"\n    schedule:\n      interval: "daily"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"terraform",children:"Terraform"}),"\n",(0,i.jsxs)(n.p,{children:["Oppdater ",(0,i.jsx)(n.code,{children:"directory"})," med riktig filsti."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "terraform"\n    directory: "/"\n    schedule:\n      interval: "daily"\n'})}),"\n",(0,i.jsxs)(n.p,{children:["Dersom det er flere mapper som inneholder Terraform kan ",(0,i.jsx)(n.code,{children:"directories"})," brukes:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "terraform"\n    directories:\n      - "dev"\n      - "prod"\n    schedule:\n      interval: "daily"\n'})}),"\n",(0,i.jsx)(n.h3,{id:"python",children:"Python"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",children:'  - package-ecosystem: "pip"\n    directory: "/"\n    schedule:\n      interval: "daily"\n'})})]})}function c(e={}){const{wrapper:n}={...(0,t.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(p,{...e})}):p(e)}}}]);