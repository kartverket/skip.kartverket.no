"use strict";(self.webpackChunkskip_docs=self.webpackChunkskip_docs||[]).push([[521],{28453:(e,n,i)=>{i.d(n,{R:()=>l,x:()=>t});var a=i(96540);const s={},r=a.createContext(s);function l(e){const n=a.useContext(r);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:l(e.components),a.createElement(r.Provider,{value:n},e.children)}},99037:(e,n,i)=>{i.r(n),i.d(n,{assets:()=>p,contentTitle:()=>t,default:()=>d,frontMatter:()=>l,metadata:()=>a,toc:()=>o});const a=JSON.parse('{"id":"applikasjon-utrulling/argokit/getting-started","title":"Kom i gang med Argokit","description":"Installer argokit i ditt apps reop","source":"@site/docs/03-applikasjon-utrulling/10-argokit/04-getting-started.md","sourceDirName":"03-applikasjon-utrulling/10-argokit","slug":"/applikasjon-utrulling/argokit/getting-started","permalink":"/docs/applikasjon-utrulling/argokit/getting-started","draft":false,"unlisted":false,"editUrl":"https://github.com/kartverket/skip-docs/edit/main/docs/03-applikasjon-utrulling/10-argokit/04-getting-started.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ArgoKit v2","permalink":"/docs/applikasjon-utrulling/argokit/argokit-v2"},"next":{"title":"AppAndObjects","permalink":"/docs/applikasjon-utrulling/argokit/appAndObjects"}}');var s=i(74848),r=i(28453);const l={},t="Kom i gang med Argokit",p={},o=[{value:"Installer argokit i ditt apps reop",id:"installer-argokit-i-ditt-apps-reop",level:3},{value:"Importer argokit",id:"importer-argokit",level:3},{value:"Definer en applikasjon",id:"definer-en-applikasjon",level:3},{value:"Bygge spec-en",id:"bygge-spec-en",level:2},{value:"Milj\xf8variabler",id:"milj\xf8variabler",level:3},{value:"Access Policies",id:"access-policies",level:3},{value:"Ingress",id:"ingress",level:3},{value:"Replicas",id:"replicas",level:3},{value:"Probes",id:"probes",level:3},{value:"Legge til flere ressursser",id:"legge-til-flere-ressursser",level:2},{value:"Azure AD Application",id:"azure-ad-application",level:3}];function c(e){const n={a:"a",code:"code",em:"em",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",p:"p",pre:"pre",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"kom-i-gang-med-argokit",children:"Kom i gang med Argokit"})}),"\n",(0,s.jsx)(n.h3,{id:"installer-argokit-i-ditt-apps-reop",children:"Installer argokit i ditt apps reop"}),"\n",(0,s.jsx)(n.p,{children:"Argokit installeres som en submodul i apps-repo slik:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"git submodule add https://github.com/kartverket/argokit.git\n"})}),"\n",(0,s.jsx)(n.p,{children:"Dersom du har klonet et apps-repo med argokit allerede installert (med vanlig git clone),\nm\xe5 du kj\xf8re f\xf8lgende kommando for \xe5 f\xe5 argokit koden:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"git submodule update --init --recursive\n"})}),"\n",(0,s.jsx)(n.h3,{id:"importer-argokit",children:"Importer argokit"}),"\n",(0,s.jsx)(n.p,{children:"Import path er relativ til hvord du befinner deg i koden."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"local argokit = import '../argokit/jsonnet/argokit.libsonnet';\n"})}),"\n",(0,s.jsx)(n.h3,{id:"definer-en-applikasjon",children:"Definer en applikasjon"}),"\n",(0,s.jsx)(n.p,{children:"Lag en ny skiperator applikasjon med argokit appAndObjects:"}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.em,{children:"Tips! Lag en ny variabel for application for \xe5 f\xe5 kortere uttrykk."})}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"local application = argokit.appAndObjects.application;\n\napplication.new('app-name') {\n  spec: {\n    port: 3000,\n    image: 'test-image'\n  }\n}\n"})}),"\n",(0,s.jsx)(n.p,{children:"\ud83c\udf89 S\xe5nn! Der har du en minimal applikasjon som kan kj\xf8res p\xe5 skip!"}),"\n",(0,s.jsxs)(n.p,{children:["\ud83e\udd14 Lurer du p\xe5 om manifestet ditt er gyldig? ",(0,s.jsx)(n.a,{href:"https://skip.kartverket.no/docs/applikasjon-utrulling/skipctl/get-started",children:"Installer skipctl"})," og kj\xf8r:"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-shell",children:"skipctl manifests validate --path=<ditt-manifest.jsonnet>\n"})}),"\n",(0,s.jsx)(n.p,{children:"s\xe5 slipper du \xe5 lure. \ud83d\ude0e"}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"bygge-spec-en",children:"Bygge spec-en"}),"\n",(0,s.jsx)(n.h3,{id:"milj\xf8variabler",children:"Milj\xf8variabler"}),"\n",(0,s.jsxs)(n.p,{children:["Med argokit kan du legge til variabler med ",(0,s.jsx)(n.code,{children:"withVariable"})," funksjonen"]}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"application.new('app-name')\n+ application.withVariable('NAME', value)\n"})}),"\n",(0,s.jsx)(n.p,{children:"Du kan ogs\xe5 legge til milj\xf8variabler fra secrets:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"application.new('app-name')\n+ application.withVariableSecret('API_KEY', 'secretRef')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"access-policies",children:"Access Policies"}),"\n",(0,s.jsx)(n.p,{children:"Det finnes en rekke funksjoner for \xe5 sette access policies i argokit,\nher kan vi sette tilgang ut til en postgres database og inn fra en\nannen skip app slik.\nHer finner du oversikt over disse funksjonene: // TODO link til referanse"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"application.new('app-name')\n+ application.withOutboundPostgres(host='database-host.com', ip='10.0.0.1')\n+ application.withInboundSkipApp(appname='other-app', namespace='other-namespace')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"ingress",children:"Ingress"}),"\n",(0,s.jsx)(n.p,{children:"Konfigurering av ingress gj\xf8res slik:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"application.new('app-name')\n+ application.forHostnames('public-api-url.com')\n"})}),"\n",(0,s.jsx)(n.h3,{id:"replicas",children:"Replicas"}),"\n",(0,s.jsx)(n.p,{children:"Replicas settes enkelt opp slik:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"application.new('app-name')\n+ application.withReplicas(initial=2, max=10)\n"})}),"\n",(0,s.jsx)(n.h3,{id:"probes",children:"Probes"}),"\n",(0,s.jsx)(n.p,{children:"Probes for startup, liveness og readiness legges til slik:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"local livenessProbe = application.probe(\n  path='/health',\n  port=8080,\n  failureThreshold=5,\n  timeout=0,\n  initialDelay=5\n);\n\nlocal readinessProbe = application.probe(path='/health', port=8080);\n\napplication.new('app-name')\n+ application.withLiveness(livenessProbe)\n+ application.withStartup(livenessProbe)\n+ application.withReadiness(readinessProbe)\n"})}),"\n",(0,s.jsx)(n.hr,{}),"\n",(0,s.jsx)(n.h2,{id:"legge-til-flere-ressursser",children:"Legge til flere ressursser"}),"\n",(0,s.jsx)(n.h3,{id:"azure-ad-application",children:"Azure AD Application"}),"\n",(0,s.jsx)(n.p,{children:"Azure AD kan legges til slik, dette vil\nlegge AzureAdApplication til som en kubernetes ressurss i manifestet\nditt, i tillegg til \xe5 legge til access policies og en secret i applikasjonen din."}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-jsonnet",children:"application.new('app-name')\n+ application.withAzureAdApplication(\n  name='app-name-ad',\n  namespace='team-namespace',\n  groups=['12345-12345-12345-12345'],\n  logoutUrl='some-url.com',\n)\n"})})]})}function d(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(c,{...e})}):c(e)}}}]);