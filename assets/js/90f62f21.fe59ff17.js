"use strict";(self.webpackChunkskip_docs=self.webpackChunkskip_docs||[]).push([[3559],{28453:(e,n,r)=>{r.d(n,{R:()=>o,x:()=>l});var t=r(96540);const i={},s=t.createContext(i);function o(e){const n=t.useContext(s);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function l(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:o(e.components),t.createElement(s.Provider,{value:n},e.children)}},50516:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>l,default:()=>g,frontMatter:()=>o,metadata:()=>t,toc:()=>d});const t=JSON.parse('{"id":"applikasjon-utrulling/tilgangsstyring/klientregistrering/maskinporten","title":"Maskinporten","description":"For \xe5 registrere en klient i Maskinporten, kan du enten gj\xf8re det i Digdir sin selvbetjeninsl\xf8sning eller","source":"@site/docs/03-applikasjon-utrulling/04-tilgangsstyring/01-klientregistrering/03-maskinporten.mdx","sourceDirName":"03-applikasjon-utrulling/04-tilgangsstyring/01-klientregistrering","slug":"/applikasjon-utrulling/tilgangsstyring/klientregistrering/maskinporten","permalink":"/docs/applikasjon-utrulling/tilgangsstyring/klientregistrering/maskinporten","draft":false,"unlisted":false,"editUrl":"https://github.com/kartverket/skip-docs/edit/main/docs/03-applikasjon-utrulling/04-tilgangsstyring/01-klientregistrering/03-maskinporten.mdx","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"ID-Porten","permalink":"/docs/applikasjon-utrulling/tilgangsstyring/klientregistrering/id-porten"},"next":{"title":"Ansattporten","permalink":"/docs/applikasjon-utrulling/tilgangsstyring/klientregistrering/ansattporten"}}');var i=r(74848),s=r(28453);const o={},l="Maskinporten",a={},d=[{value:"\ud83e\uddea Testmilj\xf8 for Maksinporten",id:"-testmilj\xf8-for-maksinporten",level:2},{value:"\ud83e\udd16 <code>MaskinportenClient</code>",id:"-maskinportenclient",level:2}];function c(e){const n={a:"a",admonition:"admonition",code:"code",em:"em",h1:"h1",h2:"h2",header:"header",p:"p",pre:"pre",strong:"strong",...(0,s.R)(),...e.components},{Details:r}=n;return r||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"maskinporten",children:"Maskinporten"})}),"\n",(0,i.jsxs)(n.p,{children:["For \xe5 registrere en klient i Maskinporten, kan du enten gj\xf8re det i Digdir sin ",(0,i.jsx)(n.a,{href:"https://sjolvbetjening.samarbeid.digdir.no/login",children:"selvbetjeninsl\xf8sning"})," eller\ngjennom Kubernetes-operatoren ",(0,i.jsx)(n.a,{href:"https://github.com/nais/digdirator",children:"Digdirator"}),". Digdirator er en Kubernetes-operator utviklet av NAV sitt plattformteam (",(0,i.jsx)(n.a,{href:"https://nais.io",children:"NAIS"}),") som skal gj\xf8re det enkelt \xe5 deklarativt sette opp og vedlikeholde\nintegrasjoner mot ",(0,i.jsx)(n.a,{href:"https://docs.digdir.no",children:"Digdir"})," sine systemer. Dette inkluderer ",(0,i.jsx)(n.strong,{children:"ID-Porten"}),"-integrasjoner og ",(0,i.jsx)(n.strong,{children:"Maskinporten"}),"-integrasjoner, men per n\xe5 ",(0,i.jsx)(n.strong,{children:"ikke"})," ",(0,i.jsx)(n.strong,{children:"Annsattporten"}),"-integrasjoner."]}),"\n",(0,i.jsx)(n.admonition,{type:"caution",children:(0,i.jsxs)(n.p,{children:["Digdirator st\xf8tter kun klientregistreringer mot ID-porten og Maskinporten. For Ansattporten m\xe5 klientregistreringer gj\xf8res manuelt i Digdir sin ",(0,i.jsx)(n.a,{href:"https://sjolvbetjening.samarbeid.digdir.no/login",children:"selvbetjeningsl\xf8sning"}),"."]})}),"\n",(0,i.jsx)(n.h2,{id:"-testmilj\xf8-for-maksinporten",children:"\ud83e\uddea Testmilj\xf8 for Maksinporten"}),"\n",(0,i.jsxs)(n.p,{children:["Digdir tilbyr Maskinporten i et testmilj\xf8, der du kan teste applikasjonen din med syntetiske organisasjoner.\nFor \xe5 registrere en klient mot Maskinporten sitt testmilj\xf8 s\xe5 kan du enten gj\xf8re det i Digdir sin ",(0,i.jsx)(n.a,{href:"https://sjolvbetjening.test.samarbeid.digdir.no/login",children:"selvbetjeningsl\xf8sning i test"}),"\neller opprette en ",(0,i.jsx)(n.code,{children:"MaskinportenClient"}),"-ressurs i dev-clustrene til SKIP, i.e. ",(0,i.jsx)(n.code,{children:"atgcp1-dev"})," eller ",(0,i.jsx)(n.code,{children:"atkv3-dev"}),"."]}),"\n",(0,i.jsxs)(n.h2,{id:"-maskinportenclient",children:["\ud83e\udd16 ",(0,i.jsx)(n.code,{children:"MaskinportenClient"})]}),"\n",(0,i.jsxs)(n.p,{children:["En ",(0,i.jsx)(n.code,{children:"MaskinportenClient"})," er en CRD som lar brukere deklarativt opprette og vedlikeholde Maskinporten-klientregistreringer."]}),"\n",(0,i.jsxs)(r,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)("strong",{children:"spec"})," ",(0,i.jsx)(n.em,{children:"(object, required)"})," \u2013 Spesifikasjon til ",(0,i.jsx)(n.code,{children:"MaskinportenClient"})]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"secretName"})," ",(0,i.jsx)(n.em,{children:"(string, required)"})," \u2013 Navnet p\xe5 den resulterende ",(0,i.jsx)(n.code,{children:"Secret"}),"-ressursen som vil bli opprettet."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"clientName"})," ",(0,i.jsx)(n.em,{children:"(string, optional)"})," \u2013 Navnet p\xe5 klienten registrert hos DigDir. Vises under innlogging for brukerorienterte flyter, og er ellers en lesbar m\xe5te \xe5 skille mellom klienter i DigDirs selvbetjeningsportal."]}),(0,i.jsxs)(r,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)("strong",{children:"scopes"})," ",(0,i.jsx)(n.em,{children:"([]object, optional)"})," \u2013 Definerer hvilke scopes applikasjonen konsumerer og hvilke den eksponerer."]}),(0,i.jsxs)(r,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)("strong",{children:"consumes"})," ",(0,i.jsx)(n.em,{children:"([]object, optional)"})," \u2013 En liste med scopes din klient kan foresp\xf8rre tilgang til."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"name"})," ",(0,i.jsx)(n.em,{children:"(string, required)"})," \u2013 Scopene som applikasjonen konsumerer for \xe5 f\xe5 tilgang til en ekstern organisasjons API."]})]}),(0,i.jsxs)(r,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)("strong",{children:"exposes"})," ",(0,i.jsx)(n.em,{children:"([]object, optional)"})," \u2013 En liste med scopes din applikasjon \xf8nsker \xe5 eksponere til andre organisasjoner hvor tilgang er basert p\xe5 organisasjonsnummer."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"enabled"})," ",(0,i.jsx)(n.em,{children:"(bool, required)"})," \u2013 Hvis ",(0,i.jsx)(n.code,{children:"true"}),", s\xe5 er det konfigurerte scopet tilgjengelig for bruk og til \xe5 bli konsumert av organisasjoner som har f\xe5tt godkjent tilgang."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"name"})," ",(0,i.jsx)(n.em,{children:"(string, p\xe5krevd)"})," \u2013 Det faktiske sub-scopet kombinert med ",(0,i.jsx)(n.code,{children:"product"}),"."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"product"})," ",(0,i.jsx)(n.em,{children:"(string, valgfritt)"})," \u2013 Produktomr\xe5de tilknyttet scopet. Dette vil inkluderes i resultatet: ",(0,i.jsx)(n.code,{children:"org:<product><name>"}),"."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"atMaxAge"})," ",(0,i.jsx)(n.em,{children:"(int, valgfritt)"})," \u2013 Maksimal tillatt levetid for token i sekunder. Defaulter til 30 sekunder."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"allowedIntegrations"})," ",(0,i.jsx)(n.em,{children:"([]string, valgfritt)"})," \u2013 Liste over tillatte integrasjonstyper for dette eksponerte omfanget. Defaulter til ",(0,i.jsx)(n.code,{children:"maskinporten"}),"."]}),(0,i.jsxs)(r,{children:[(0,i.jsxs)("summary",{children:[(0,i.jsx)("strong",{children:"consumers"})," ",(0,i.jsx)(n.em,{children:"([]object, valgfritt)"})," \u2013 Liste over eksterne konsumenter som har tilgang til \xe5 konsumere dette scopet og som kan foresp\xf8rre ",(0,i.jsx)(n.code,{children:"access_token"}),"."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"orgno"})," \u2013 Det eksterne organisasjonsnummeret."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"name"})," \u2013 Beskrivende felt brukt utelukkende for oversikt."]})]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"accessibleForAll"})," \u2013 Tillater alle organisasjoner \xe5 f\xe5 tilgang til scopet."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"delegationSource"})," \u2013 Delegasjonskilde for scopet. Default er tomt, noe som betyr at ingen delegasjon er tillatt."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"separator"})," \u2013 Tegnet som skiller ",(0,i.jsx)(n.code,{children:"product"})," og ",(0,i.jsx)(n.code,{children:"name"})," i det endelige scopet. Resultatet blir da ",(0,i.jsx)(n.code,{children:"<prefix>:<product><separator><name>"}),". Defaulter til ",(0,i.jsx)(n.code,{children:":"})," med mindre ",(0,i.jsx)(n.code,{children:"name"})," inneholder ",(0,i.jsx)(n.code,{children:"/"}),", i det tilfellet defaultes det til ",(0,i.jsx)(n.code,{children:"/"}),"."]}),(0,i.jsxs)("p",{children:[(0,i.jsx)("strong",{children:"visibility"})," \u2013 Kontrollerer synligheten til scopet. Offentlige scopes er synlige for alle, mens private scopes kun er synlige for organisasjonen som eier scopet og organisasjoner som har f\xe5tt tilgang som konsumenter. Defaulter til ",(0,i.jsx)(n.code,{children:"public"}),". Tillatte verdier: ",(0,i.jsx)(n.code,{children:"private"}),", ",(0,i.jsx)(n.code,{children:"public"}),"."]})]})]})]}),"\n",(0,i.jsxs)(n.p,{children:["F\xf8lgende eksempel oppretter en klientintegrasjon mot Maskinporten og definerer scopet ",(0,i.jsx)(n.code,{children:"innsyn"}),".\nDen setter HUSL\xd8S HURTIG TIGER AS og KOSTBAR LEKKER APE AS som godkjente konsumenter av scopet.\nN\xe5r registrering er fullf\xf8rt vil Digdirator opprette Kubernetes-hemmeligheten ",(0,i.jsx)(n.code,{children:"maskinporten-secret"})," i namespacet ",(0,i.jsx)(n.code,{children:"tilgangsstyring-main"}),"."]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="Klientregistrering mot Maskinporten med Digdirator"',children:'apiVersion: nais.io/v1\nkind: MaskinportenClient\nmetadata:\n  name: test-client\n  namespace: tilgangsstyring-main\nspec:\n  clientName: innsikt-secure-deltashare\n  scopes:\n    exposes:\n      - enabled: true\n        name: "innsyn"\n        product: "Produktomr\xe5de"\n        consumers:\n          - name: HUSL\xd8S HURTIG TIGER AS\n            orgno: "987654321"\n          - name: KOSTBAR LEKKER APE AS\n            orgno: "123456789"\n  secretName: maskinporten-secret\n'})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-yaml",metastring:'title="Hemmelighet opprettet av Digdirator etter fullf\xf8rt klientregistrering"',children:"apiVersion: v1\nkind: Secret\nmetadata:\n  name: maskinporten-secret\n  namespace: tilgangsstyring-main\ndata:\n  MASKINPORTEN_CLIENT_ID: ++++++++\n  MASKINPORTEN_CLIENT_JWK: ++++++++\n  MASKINPORTEN_ISSUER: ++++++++\n  MASKINPORTEN_JWKS_URI: ++++++++\n  MASKINPORTEN_SCOPES: ++++++++\n  MASKINPORTEN_TOKEN_ENDPOINT: ++++++++\n  MASKINPORTEN_WELL_KNOWN_URL: ++++++++\ntype: Opaque\n"})})]})}function g(e={}){const{wrapper:n}={...(0,s.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(c,{...e})}):c(e)}}}]);